import{AbiEncodingLengthMismatchError as f,InvalidAbiEncodingTypeError as y,InvalidArrayError as g,AbiEncodingArrayLengthMismatchError as b,AbiEncodingBytesSizeMismatchError as w}from"./index108.js";import{InvalidAddressError as A}from"./index52.js";import{BaseError as v}from"./index72.js";import{isAddress as E}from"./index53.js";import{concat as d}from"./index76.js";import{padHex as c}from"./index71.js";import{size as p}from"./index74.js";import{slice as x}from"./index107.js";import{numberToHex as m,boolToHex as z,stringToHex as L}from"./index42.js";function I(n,t){if(n.length!==t.length)throw new f({expectedLength:n.length,givenLength:t.length});const e=M({params:n,values:t}),r=l(e);return r.length===0?"0x":r}function M({params:n,values:t}){const e=[];for(let r=0;r<n.length;r++)e.push(u({param:n[r],value:t[r]}));return e}function u({param:n,value:t}){const e=h(n.type);if(e){const[r,o]=e;return H(t,{length:r,param:{...n,type:o}})}if(n.type==="tuple")return C(t,{param:n});if(n.type==="address")return $(t);if(n.type==="bool")return P(t);if(n.type.startsWith("uint")||n.type.startsWith("int")){const r=n.type.startsWith("int");return W(t,{signed:r})}if(n.type.startsWith("bytes"))return T(t,{param:n});if(n.type==="string")return B(t);throw new y(n.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function l(n){let t=0;for(let i=0;i<n.length;i++){const{dynamic:a,encoded:s}=n[i];a?t+=32:t+=p(s)}const e=[],r=[];let o=0;for(let i=0;i<n.length;i++){const{dynamic:a,encoded:s}=n[i];a?(e.push(m(t+o,{size:32})),r.push(s),o+=p(s)):e.push(s)}return d([...e,...r])}function $(n){if(!E(n))throw new A({address:n});return{dynamic:!1,encoded:c(n.toLowerCase())}}function H(n,{length:t,param:e}){const r=t===null;if(!Array.isArray(n))throw new g(n);if(!r&&n.length!==t)throw new b({expectedLength:t,givenLength:n.length,type:`${e.type}[${t}]`});let o=!1;const i=[];for(let a=0;a<n.length;a++){const s=u({param:e,value:n[a]});s.dynamic&&(o=!0),i.push(s)}if(r||o){const a=l(i);if(r){const s=m(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?d([s,a]):s}}if(o)return{dynamic:!0,encoded:a}}return{dynamic:!1,encoded:d(i.map(({encoded:a})=>a))}}function T(n,{param:t}){const[,e]=t.type.split("bytes"),r=p(n);if(!e){let o=n;return r%32!==0&&(o=c(o,{dir:"right",size:Math.ceil((n.length-2)/2/32)*32})),{dynamic:!0,encoded:d([c(m(r,{size:32})),o])}}if(r!==Number.parseInt(e))throw new w({expectedSize:Number.parseInt(e),value:n});return{dynamic:!1,encoded:c(n,{dir:"right"})}}function P(n){if(typeof n!="boolean")throw new v(`Invalid boolean value: "${n}" (type: ${typeof n}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:c(z(n))}}function W(n,{signed:t}){return{dynamic:!1,encoded:m(n,{size:32,signed:t})}}function B(n){const t=L(n),e=Math.ceil(p(t)/32),r=[];for(let o=0;o<e;o++)r.push(c(x(t,o*32,(o+1)*32),{dir:"right"}));return{dynamic:!0,encoded:d([c(m(p(t),{size:32})),...r])}}function C(n,{param:t}){let e=!1;const r=[];for(let o=0;o<t.components.length;o++){const i=t.components[o],a=Array.isArray(n)?o:i.name,s=u({param:i,value:n[a]});r.push(s),s.dynamic&&(e=!0)}return{dynamic:e,encoded:e?l(r):d(r.map(({encoded:o})=>o))}}function h(n){const t=n.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}export{I as encodeAbiParameters,h as getArrayComponents};
