import{HashMD as j}from"./index63.js";import{wrapConstructor as k,rotl as w}from"./index38.js";const B=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),b=new Uint8Array(new Array(16).fill(0).map((h,t)=>t)),F=b.map(h=>(9*h+5)%16);let U=[b],d=[F];for(let h=0;h<4;h++)for(let t of[U,d])t.push(t[h].map(s=>B[s]));const g=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(h=>new Uint8Array(h)),G=U.map((h,t)=>h.map(s=>g[t][s])),J=d.map((h,t)=>h.map(s=>g[t][s])),K=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),L=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function x(h,t,s,i){return h===0?t^s^i:h===1?t&s|~t&i:h===2?(t|~s)^i:h===3?t&i|s&~i:t^(s|~i)}const y=new Uint32Array(16);class C extends j{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:s,h2:i,h3:e,h4:n}=this;return[t,s,i,e,n]}set(t,s,i,e,n){this.h0=t|0,this.h1=s|0,this.h2=i|0,this.h3=e|0,this.h4=n|0}process(t,s){for(let r=0;r<16;r++,s+=4)y[r]=t.getUint32(s,!0);let i=this.h0|0,e=i,n=this.h1|0,f=n,a=this.h2|0,c=a,l=this.h3|0,m=l,p=this.h4|0,u=p;for(let r=0;r<5;r++){const D=4-r,M=K[r],E=L[r],H=U[r],I=d[r],P=G[r],R=J[r];for(let o=0;o<16;o++){const A=w(i+x(r,n,a,l)+y[H[o]]+M,P[o])+p|0;i=p,p=l,l=w(a,10)|0,a=n,n=A}for(let o=0;o<16;o++){const A=w(e+x(D,f,c,m)+y[I[o]]+E,R[o])+u|0;e=u,u=m,m=w(c,10)|0,c=f,f=A}}this.set(this.h1+a+m|0,this.h2+l+u|0,this.h3+p+e|0,this.h4+i+f|0,this.h0+n+c|0)}roundClean(){y.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const _=k(()=>new C);export{C as RIPEMD160,_ as ripemd160};
