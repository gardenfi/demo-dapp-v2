import{InvalidLegacyVError as H}from"./index80.js";import{blobsToCommitments as B}from"./index81.js";import{blobsToProofs as k}from"./index82.js";import{commitmentsToVersionedHashes as A}from"./index83.js";import{toBlobSidecars as V}from"./index84.js";import{concatHex as h}from"./index76.js";import{trim as I}from"./index85.js";import{toHex as s,bytesToHex as w}from"./index42.js";import{toRlp as y}from"./index77.js";import{serializeAuthorizationList as S}from"./index86.js";import{assertTransactionEIP7702 as C,assertTransactionEIP4844 as R,assertTransactionEIP1559 as Y,assertTransactionEIP2930 as j,assertTransactionLegacy as q}from"./index87.js";import{getTransactionType as D}from"./index88.js";import{serializeAccessList as T}from"./index89.js";function J(t,o){const n=D(t);return n==="eip1559"?N(t,o):n==="eip2930"?_(t,o):n==="eip4844"?M(t,o):n==="eip7702"?K(t,o):O(t,o)}function K(t,o){const{authorizationList:n,chainId:a,gas:i,nonce:e,to:c,value:x,maxFeePerGas:m,maxPriorityFeePerGas:r,accessList:l,data:p}=t;C(t);const u=T(l),f=S(n);return h(["0x04",y([s(a),e?s(e):"0x",r?s(r):"0x",m?s(m):"0x",i?s(i):"0x",c??"0x",x?s(x):"0x",p??"0x",u,f,...g(t,o)])])}function M(t,o){const{chainId:n,gas:a,nonce:i,to:e,value:c,maxFeePerBlobGas:x,maxFeePerGas:m,maxPriorityFeePerGas:r,accessList:l,data:p}=t;R(t);let u=t.blobVersionedHashes,f=t.sidecars;if(t.blobs&&(typeof u>"u"||typeof f>"u")){const b=typeof t.blobs[0]=="string"?t.blobs:t.blobs.map(d=>w(d)),v=t.kzg,P=B({blobs:b,kzg:v});if(typeof u>"u"&&(u=A({commitments:P})),typeof f>"u"){const d=k({blobs:b,commitments:P,kzg:v});f=V({blobs:b,commitments:P,proofs:d})}}const E=T(l),z=[s(n),i?s(i):"0x",r?s(r):"0x",m?s(m):"0x",a?s(a):"0x",e??"0x",c?s(c):"0x",p??"0x",E,x?s(x):"0x",u??[],...g(t,o)],L=[],F=[],G=[];if(f)for(let b=0;b<f.length;b++){const{blob:v,commitment:P,proof:d}=f[b];L.push(v),F.push(P),G.push(d)}return h(["0x03",f?y([z,L,F,G]):y(z)])}function N(t,o){const{chainId:n,gas:a,nonce:i,to:e,value:c,maxFeePerGas:x,maxPriorityFeePerGas:m,accessList:r,data:l}=t;Y(t);const p=T(r),u=[s(n),i?s(i):"0x",m?s(m):"0x",x?s(x):"0x",a?s(a):"0x",e??"0x",c?s(c):"0x",l??"0x",p,...g(t,o)];return h(["0x02",y(u)])}function _(t,o){const{chainId:n,gas:a,data:i,nonce:e,to:c,value:x,accessList:m,gasPrice:r}=t;j(t);const l=T(m),p=[s(n),e?s(e):"0x",r?s(r):"0x",a?s(a):"0x",c??"0x",x?s(x):"0x",i??"0x",l,...g(t,o)];return h(["0x01",y(p)])}function O(t,o){const{chainId:n=0,gas:a,data:i,nonce:e,to:c,value:x,gasPrice:m}=t;q(t);let r=[e?s(e):"0x",m?s(m):"0x",a?s(a):"0x",c??"0x",x?s(x):"0x",i??"0x"];if(o){const l=(()=>{if(o.v>=35n)return(o.v-35n)/2n>0?o.v:27n+(o.v===35n?0n:1n);if(n>0)return BigInt(n*2)+BigInt(35n+o.v-27n);const f=27n+(o.v===27n?0n:1n);if(o.v!==f)throw new H({v:o.v});return f})(),p=I(o.r),u=I(o.s);r=[...r,s(l),p==="0x00"?"0x":p,u==="0x00"?"0x":u]}else n>0&&(r=[...r,s(n),"0x","0x"]);return y(r)}function g(t,o){const n=o??t,{v:a,yParity:i}=n;if(typeof n.r>"u")return[];if(typeof n.s>"u")return[];if(typeof a>"u"&&typeof i>"u")return[];const e=I(n.r),c=I(n.s);return[typeof i=="number"?i?s(1):"0x":a===0n?"0x":a===1n?s(1):a===27n?"0x":s(1),e==="0x00"?"0x":e,c==="0x00"?"0x":c]}export{J as serializeTransaction,g as toYParitySignatureArray};
