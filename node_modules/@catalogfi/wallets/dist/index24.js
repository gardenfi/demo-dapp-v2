import{script as a,payments as P,address as n}from"bitcoinjs-lib";const E=(e,c,i=!1)=>{const t=s=>{try{s=n.fromBech32(s).data.toString("hex")}catch(r){if(r.message.includes("Mixed-case string")||r.message.includes("too short"))s=n.fromBase58Check(s).hash.toString("hex");else throw new Error(r)}return s},d=a.fromASM(`
          OP_IF
              OP_SHA256
              ${e.secretHash}
              OP_EQUALVERIFY
              OP_DUP
              OP_HASH160
              ${t(e.recipientAddress.address)}
          OP_ELSE
              ${a.number.encode(e.expiryBlocks).toString("hex")}
              OP_CHECKSEQUENCEVERIFY
              OP_DROP
              OP_DUP
              OP_HASH160
              ${t(e.refundAddress.address)}
              OP_ENDIF
            OP_EQUALVERIFY
            OP_CHECKSIG
      `.trim().replace(/\s+/g," ")),o=P[i?"p2sh":"p2wsh"]({redeem:{output:d},network:c});if(!o.address)throw new Error("Could not build address");return{script:d,address:o.address}};export{E as getHTLCScript};
