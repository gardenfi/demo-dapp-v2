"use strict";const n=require("crypto"),d=require("./index5.js"),s=class s{static encrypt(c,e){const t=this.generateSalt(),r=this.generateKey(e,t);return{encryptedData:this.encryptAES(c,r,t),key:r,salt:t}}static encryptWithKey(c,e,t){return{encryptedData:this.encryptAES(c,e,t),key:e,salt:t}}static decrypt(c,e,t){const r=this.generateKey(e,t);return{decryptedData:this.decryptAES(c,r,t),key:r,salt:t}}static decryptWithKey(c,e,t){return{decryptedData:this.decryptAES(c,e,t),key:e,salt:t}}static encryptAES(c,e,t){const r=n.createCipheriv(this.algorithm,e,t),a=r.update(c);return Buffer.concat([a,r.final()]).toString("hex")}static decryptAES(c,e,t){try{const r=n.createDecipheriv(this.algorithm,e,t),a=r.update(Buffer.from(c,"hex"));return Buffer.concat([a,r.final()]).toString()}catch(r){throw r.message.includes("bad decrypt")?new Error(d.INVALID_PASSWORD):r}}static generateKey(c,e){return n.pbkdf2Sync(c,e,1e3,32,"sha512").toString("hex").slice(0,32)}static generateSalt(){return n.randomBytes(16).toString("hex").slice(0,16)}};s.algorithm="aes-256-cbc";let i=s;module.exports=i;
