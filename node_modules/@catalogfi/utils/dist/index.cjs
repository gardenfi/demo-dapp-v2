"use strict";var g=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var l=(t,e,r)=>(g(t,e,"read from private field"),r?r.call(t):e.get(t)),h=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},y=(t,e,r,s)=>(g(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const d=t=>new Promise(e=>setTimeout(e,t));class x{constructor(e,r){this.maxRetries=Math.max(e,0),this.delay=r}async retry(e){let r=0,s;for(;r<this.maxRetries+1;)try{return await e()}catch(n){r++,s=n,await d(this.delay*r)}throw s}}const w=t=>{try{return JSON.parse(t)}catch{return t}};class k{static async _postWithFallback(e,r){let s="";for(const n of e)try{const a=await fetch(n,{method:"POST",...r});if(a.status>=500){s=await(a.text()||a.json());continue}return await this.parse(a)}catch(a){s=p(a);continue}throw new Error(s||"All APIs failed")}static async postWithFallback(e,r){return await f(r).retry(()=>this._postWithFallback(e,r))}static async _getWithFallback(e,r){let s="";for(const n of e)try{const a=await fetch(n,r);if(a.status>=500){s=await(a.text()||a.json());continue}return await this.parse(a)}catch(a){s=p(a);continue}throw new Error(s||"All APIs failed")}static async getWithFallback(e,r){return await f(r).retry(()=>this._getWithFallback(e,r))}static async _get(e,r){return await this.parse(await fetch(e,r))}static async get(e,r){return await f(r).retry(()=>this._get(e,r))}static async _post(e,r){return await this.parse(await fetch(e,{method:"POST",...r}))}static async post(e,r){return await f(r).retry(()=>this._post(e,r))}static async parse(e){const r=await e.text();if(e.status>=200&&e.status<300)return w(r);throw new Error(r)}}function p(t){return(t==null?void 0:t.message)||(t==null?void 0:t.toString())||"unknown error"}const f=t=>new x((t==null?void 0:t.retryCount)??2,(t==null?void 0:t.retryDelay)??1e3);class S{constructor(e){this.url=e}async sendRequest(e){try{return await k.post(this.url,{body:JSON.stringify(e)})}catch(r){return w(r.message)}}}const W=(t,e)=>{if(!t)throw new Error(e);return t},F=t=>t.startsWith("0x")?t:`0x${t}`,E=t=>t.startsWith("0x")?t.slice(2):t;var i,o,u;class c{constructor(e,r,s=void 0){h(this,i,void 0);h(this,o,void 0);h(this,u,void 0);y(this,i,e),y(this,u,s),y(this,o,r)}get ok(){return l(this,i)}get error(){return l(this,u)}get val(){return l(this,o)}}i=new WeakMap,o=new WeakMap,u=new WeakMap;const b=t=>new c(!0,t),O=void 0,R=(t,...e)=>{if(typeof t=="string"&&e&&e.length>0){let r=[t,...e].map(s=>{if(s){if(s instanceof Error)return s.message;if(typeof s=="string")return s;if(typeof s=="object")return JSON.stringify(s);if(s!=null&&s.toString)return s.toString()}});return new c(!1,null,r.filter(s=>s!==void 0).join(" "))}return new c(!1,null,t)};async function P(t,e="Failed to execute"){try{const r=await t();return r instanceof c?r:b(r)}catch(r){return R(e+": ",r)}}exports.Err=R;exports.Fetcher=k;exports.JsonRpc=S;exports.Ok=b;exports.Result=c;exports.Retry=x;exports.Void=O;exports.ensureVal=W;exports.executeWithTryCatch=P;exports.safeParseJson=w;exports.sleep=d;exports.trim0x=E;exports.with0x=F;
