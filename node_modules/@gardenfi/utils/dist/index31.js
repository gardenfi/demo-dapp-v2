import { wait as w } from "./index39.js";
function p(n, { delay: e = 100, retryCount: o = 2, shouldRetry: c = () => !0 } = {}) {
  return new Promise((s, y) => {
    const a = async ({ count: r = 0 } = {}) => {
      const f = async ({ error: t }) => {
        const i = typeof e == "function" ? e({ count: r, error: t }) : e;
        i && await w(i), a({ count: r + 1 });
      };
      try {
        const t = await n();
        s(t);
      } catch (t) {
        if (r < o && await c({ count: r, error: t }))
          return f({ error: t });
        y(t);
      }
    };
    a();
  });
}
export {
  p as withRetry
};
