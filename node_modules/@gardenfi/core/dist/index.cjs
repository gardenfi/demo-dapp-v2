"use strict";var Us=Object.defineProperty;var Ms=(e,t,r)=>t in e?Us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var bt=(e,t,r)=>Ms(e,typeof t!="symbol"?t+"":t,r);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const P=require("@catalogfi/utils"),J=require("@gardenfi/orderbook"),we=require("@gardenfi/utils"),He=require("viem"),Ns=require("varuint-bitcoin"),Ds=require("tiny-secp256k1"),gi=require("bitcoinjs-lib"),In=require("@catalogfi/wallets"),$s=require("bignumber.js");function fn(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const r in e)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:()=>e[r]})}}return t.default=e,Object.freeze(t)}const Rn=fn(Ns),st=fn(Ds),ue=fn(gi);var or=(e=>(e[e.evm=14400]="evm",e[e.btc=288]="btc",e))(or||{}),ce=(e=>(e.Idle="Idle",e.Initiate="Initiate",e.Redeem="Redeem",e.Refund="Refund",e))(ce||{});function Wt(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}const mi="2.21.30";let kt={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,version:`viem@${mi}`};class Q extends Error{constructor(t,r={}){var u;const n=(()=>{var l;return r.cause instanceof Q?r.cause.details:(l=r.cause)!=null&&l.message?r.cause.message:r.details})(),i=r.cause instanceof Q&&r.cause.docsPath||r.docsPath,a=(u=kt.getDocsUrl)==null?void 0:u.call(kt,{...r,docsPath:i}),f=[t||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...a?[`Docs: ${a}`]:[],...n?[`Details: ${n}`]:[],...kt.version?[`Version: ${kt.version}`]:[]].join(`
`);super(f,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=i,this.metaMessages=r.metaMessages,this.name=r.name??this.name,this.shortMessage=t,this.version=mi}walk(t){return _i(this,t)}}function _i(e,t){return t!=null&&t(e)?e:e&&typeof e=="object"&&"cause"in e?_i(e.cause,t):t?null:e}class Hs extends Q{constructor({max:t,min:r,signed:n,size:i,value:a}){super(`Number "${a}" is not in safe ${i?`${i*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${t?`(${r} to ${t})`:`(above ${r})`}`,{name:"IntegerOutOfRangeError"})}}class zs extends Q{constructor({givenSize:t,maxSize:r}){super(`Size cannot exceed ${r} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}}function qt(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function xt(e){return qt(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}function ar(e,{dir:t="left"}={}){let r=typeof e=="string"?e.replace("0x",""):e,n=0;for(let i=0;i<r.length-1&&r[t==="left"?i:r.length-i-1].toString()==="0";i++)n++;return r=t==="left"?r.slice(n):r.slice(0,r.length-n),typeof e=="string"?(r.length===1&&t==="right"&&(r=`${r}0`),`0x${r.length%2===1?`0${r}`:r}`):r}class js extends Q{constructor({offset:t,position:r,size:n}){super(`Slice ${r==="start"?"starting":"ending"} at offset "${t}" is out-of-bounds (size: ${n}).`,{name:"SliceOffsetOutOfBoundsError"})}}class wi extends Q{constructor({size:t,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${t}) exceeds padding size (${r}).`,{name:"SizeExceedsPaddingSizeError"})}}function St(e,{dir:t,size:r=32}={}){return typeof e=="string"?Gs(e,{dir:t,size:r}):Ws(e,{dir:t,size:r})}function Gs(e,{dir:t,size:r=32}={}){if(r===null)return e;const n=e.replace("0x","");if(n.length>r*2)throw new wi({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n[t==="right"?"padEnd":"padStart"](r*2,"0")}`}function Ws(e,{dir:t,size:r=32}={}){if(r===null)return e;if(e.length>r)throw new wi({size:e.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let i=0;i<r;i++){const a=t==="right";n[a?i:r-i-1]=e[a?i:e.length-i-1]}return n}const qs=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function W(e,t={}){return typeof e=="number"||typeof e=="bigint"?xi(e,t):typeof e=="string"?Ys(e,t):typeof e=="boolean"?Vs(e,t):Ze(e,t)}function Vs(e,t={}){const r=`0x${Number(e)}`;return typeof t.size=="number"?(At(r,{size:t.size}),St(r,{size:t.size})):r}function Ze(e,t={}){let r="";for(let i=0;i<e.length;i++)r+=qs[e[i]];const n=`0x${r}`;return typeof t.size=="number"?(At(n,{size:t.size}),St(n,{dir:"right",size:t.size})):n}function xi(e,t={}){const{signed:r,size:n}=t,i=BigInt(e);let a;n?r?a=(1n<<BigInt(n)*8n-1n)-1n:a=2n**(BigInt(n)*8n)-1n:typeof e=="number"&&(a=BigInt(Number.MAX_SAFE_INTEGER));const f=typeof a=="bigint"&&r?-a-1n:0;if(a&&i>a||i<f){const l=typeof e=="bigint"?"n":"";throw new Hs({max:a?`${a}${l}`:void 0,min:`${f}${l}`,signed:r,size:n,value:`${e}${l}`})}const u=`0x${(r&&i<0?(1n<<BigInt(n*8))+BigInt(i):i).toString(16)}`;return n?St(u,{size:n}):u}const Ks=new TextEncoder;function Ys(e,t={}){const r=Ks.encode(e);return Ze(r,t)}const Js=new TextEncoder;function vi(e,t={}){return typeof e=="number"||typeof e=="bigint"?Qs(e,t):typeof e=="boolean"?Xs(e,t):qt(e)?ot(e,t):Ei(e,t)}function Xs(e,t={}){const r=new Uint8Array(1);return r[0]=Number(e),typeof t.size=="number"?(At(r,{size:t.size}),St(r,{size:t.size})):r}const Ne={zero:48,nine:57,A:65,F:70,a:97,f:102};function Tn(e){if(e>=Ne.zero&&e<=Ne.nine)return e-Ne.zero;if(e>=Ne.A&&e<=Ne.F)return e-(Ne.A-10);if(e>=Ne.a&&e<=Ne.f)return e-(Ne.a-10)}function ot(e,t={}){let r=e;t.size&&(At(r,{size:t.size}),r=St(r,{dir:"right",size:t.size}));let n=r.slice(2);n.length%2&&(n=`0${n}`);const i=n.length/2,a=new Uint8Array(i);for(let f=0,u=0;f<i;f++){const l=Tn(n.charCodeAt(u++)),b=Tn(n.charCodeAt(u++));if(l===void 0||b===void 0)throw new Q(`Invalid byte sequence ("${n[u-2]}${n[u-1]}" in "${n}").`);a[f]=l*16+b}return a}function Qs(e,t){const r=xi(e,t);return ot(r)}function Ei(e,t={}){const r=Js.encode(e);return typeof t.size=="number"?(At(r,{size:t.size}),St(r,{dir:"right",size:t.size})):r}function At(e,{size:t}){if(xt(e)>t)throw new zs({givenSize:xt(e),maxSize:t})}function mt(e,t={}){const{signed:r}=t;t.size&&At(e,{size:t.size});const n=BigInt(e);if(!r)return n;const i=(e.length-2)/2,a=(1n<<BigInt(i)*8n-1n)-1n;return n<=a?n:n-BigInt(`0x${"f".padStart(i*2,"f")}`)-1n}function fr(e,t={}){return Number(mt(e,t))}function un(e,t){return({exclude:r,format:n})=>({exclude:r,format:i=>{const a=t(i);if(r)for(const f of r)delete a[f];return{...a,...n(i)}},type:e})}const Bi={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function cn(e){const t={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?fr(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerBlobGas:e.maxFeePerBlobGas?BigInt(e.maxFeePerBlobGas):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?fr(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?Bi[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return e.authorizationList&&(t.authorizationList=eo(e.authorizationList)),t.yParity=(()=>{if(e.yParity)return Number(e.yParity);if(typeof t.v=="bigint"){if(t.v===0n||t.v===27n)return 0;if(t.v===1n||t.v===28n)return 1;if(t.v>=35n)return t.v%2n===0n?1:0}})(),t.type==="legacy"&&(delete t.accessList,delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),t.type==="eip2930"&&(delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),t.type==="eip1559"&&delete t.maxFeePerBlobGas,t}const Zs=un("transaction",cn);function eo(e){return e.map(t=>({contractAddress:t.address,chainId:Number(t.chainId),nonce:Number(t.nonce),r:t.r,s:t.s,yParity:Number(t.yParity)}))}function to(e){var r;const t=(r=e.transactions)==null?void 0:r.map(n=>typeof n=="string"?n:cn(n));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,blobGasUsed:e.blobGasUsed?BigInt(e.blobGasUsed):void 0,difficulty:e.difficulty?BigInt(e.difficulty):void 0,excessBlobGas:e.excessBlobGas?BigInt(e.excessBlobGas):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:t,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}const ro=un("block",to);function no(e,{args:t,eventName:r}={}){return{...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,logIndex:e.logIndex?Number(e.logIndex):null,transactionHash:e.transactionHash?e.transactionHash:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,...r?{args:t,eventName:r}:{}}}const io={"0x0":"reverted","0x1":"success"};function so(e){const t={...e,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs?e.logs.map(r=>no(r)):null,to:e.to?e.to:null,transactionIndex:e.transactionIndex?fr(e.transactionIndex):null,status:e.status?io[e.status]:null,type:e.type?Bi[e.type]||e.type:null};return e.blobGasPrice&&(t.blobGasPrice=BigInt(e.blobGasPrice)),e.blobGasUsed&&(t.blobGasUsed=BigInt(e.blobGasUsed)),t}const oo=un("transactionReceipt",so),ln=2n**256n-1n;function Vt(e){return`0x${e.reduce((t,r)=>t+r.replace("0x",""),"")}`}class Pn extends Q{constructor({offset:t}){super(`Offset \`${t}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class ao extends Q{constructor({length:t,position:r}){super(`Position \`${r}\` is out of bounds (\`0 < position < ${t}\`).`,{name:"PositionOutOfBoundsError"})}}class fo extends Q{constructor({count:t,limit:r}){super(`Recursive read limit of \`${r}\` exceeded (recursive read count: \`${t}\`).`,{name:"RecursiveReadLimitExceededError"})}}const uo={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new fo({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(e){if(e<0||e>this.bytes.length-1)throw new ao({length:this.bytes.length,position:e})},decrementPosition(e){if(e<0)throw new Pn({offset:e});const t=this.position-e;this.assertPosition(t),this.position=t},getReadCount(e){return this.positionReadCount.get(e||this.position)||0},incrementPosition(e){if(e<0)throw new Pn({offset:e});const t=this.position+e;this.assertPosition(t),this.position=t},inspectByte(e){const t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectBytes(e,t){const r=t??this.position;return this.assertPosition(r+e-1),this.bytes.subarray(r,r+e)},inspectUint8(e){const t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectUint16(e){const t=e??this.position;return this.assertPosition(t+1),this.dataView.getUint16(t)},inspectUint24(e){const t=e??this.position;return this.assertPosition(t+2),(this.dataView.getUint16(t)<<8)+this.dataView.getUint8(t+2)},inspectUint32(e){const t=e??this.position;return this.assertPosition(t+3),this.dataView.getUint32(t)},pushByte(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushBytes(e){this.assertPosition(this.position+e.length-1),this.bytes.set(e,this.position),this.position+=e.length},pushUint8(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushUint16(e){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,e),this.position+=2},pushUint24(e){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,e>>8),this.dataView.setUint8(this.position+2,e&255),this.position+=3},pushUint32(e){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,e),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const e=this.inspectByte();return this.position++,e},readBytes(e,t){this.assertReadLimit(),this._touch();const r=this.inspectBytes(e);return this.position+=t??e,r},readUint8(){this.assertReadLimit(),this._touch();const e=this.inspectUint8();return this.position+=1,e},readUint16(){this.assertReadLimit(),this._touch();const e=this.inspectUint16();return this.position+=2,e},readUint24(){this.assertReadLimit(),this._touch();const e=this.inspectUint24();return this.position+=3,e},readUint32(){this.assertReadLimit(),this._touch();const e=this.inspectUint32();return this.position+=4,e},get remaining(){return this.bytes.length-this.position},setPosition(e){const t=this.position;return this.assertPosition(e),this.position=e,()=>this.position=t},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const e=this.getReadCount();this.positionReadCount.set(this.position,e+1),e>0&&this.recursiveReadCount++}};function Si(e,{recursiveReadLimit:t=8192}={}){const r=Object.create(uo);return r.bytes=e,r.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength),r.positionReadCount=new Map,r.recursiveReadLimit=t,r}function at(e,t="hex"){const r=Ai(e),n=Si(new Uint8Array(r.length));return r.encode(n),t==="hex"?Ze(n.bytes):n.bytes}function Ai(e){return Array.isArray(e)?co(e.map(t=>Ai(t))):lo(e)}function co(e){const t=e.reduce((i,a)=>i+a.length,0),r=Ii(t);return{length:t<=55?1+t:1+r+t,encode(i){t<=55?i.pushByte(192+t):(i.pushByte(247+r),r===1?i.pushUint8(t):r===2?i.pushUint16(t):r===3?i.pushUint24(t):i.pushUint32(t));for(const{encode:a}of e)a(i)}}}function lo(e){const t=typeof e=="string"?ot(e):e,r=Ii(t.length);return{length:t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+r+t.length,encode(i){t.length===1&&t[0]<128?i.pushBytes(t):t.length<=55?(i.pushByte(128+t.length),i.pushBytes(t)):(i.pushByte(183+r),r===1?i.pushUint8(t.length):r===2?i.pushUint16(t.length):r===3?i.pushUint24(t.length):i.pushUint32(t.length),i.pushBytes(t))}}}function Ii(e){if(e<2**8)return 1;if(e<2**16)return 2;if(e<2**24)return 3;if(e<2**32)return 4;throw new Q("Length is too large.")}const ho={ether:-9,wei:9};function po(e,t){let r=e.toString();const n=r.startsWith("-");n&&(r=r.slice(1)),r=r.padStart(t,"0");let[i,a]=[r.slice(0,r.length-t),r.slice(r.length-t)];return a=a.replace(/(0+)$/,""),`${n?"-":""}${i||"0"}${a?`.${a}`:""}`}function Jr(e,t="wei"){return po(e,ho[t])}function bo(e){const t=Object.entries(e).map(([n,i])=>i===void 0||i===!1?null:[n,i]).filter(Boolean),r=t.reduce((n,[i])=>Math.max(n,i.length),0);return t.map(([n,i])=>`  ${`${n}:`.padEnd(r+1)}  ${i}`).join(`
`)}class yo extends Q{constructor({v:t}){super(`Invalid \`v\` value "${t}". Expected 27 or 28.`,{name:"InvalidLegacyVError"})}}class go extends Q{constructor({transaction:t}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",bo(t),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}class mo extends Q{constructor({storageKey:t}){super(`Size for storage key "${t}" is invalid. Expected 32 bytes. Got ${Math.floor((t.length-2)/2)} bytes.`,{name:"InvalidStorageKeySizeError"})}}function Ri(e){const{kzg:t}=e,r=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),n=typeof e.blobs[0]=="string"?e.blobs.map(a=>ot(a)):e.blobs,i=[];for(const a of n)i.push(Uint8Array.from(t.blobToKzgCommitment(a)));return r==="bytes"?i:i.map(a=>Ze(a))}function Ti(e){const{kzg:t}=e,r=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),n=typeof e.blobs[0]=="string"?e.blobs.map(f=>ot(f)):e.blobs,i=typeof e.commitments[0]=="string"?e.commitments.map(f=>ot(f)):e.commitments,a=[];for(let f=0;f<n.length;f++){const u=n[f],l=i[f];a.push(Uint8Array.from(t.computeBlobKzgProof(u,l)))}return r==="bytes"?a:a.map(f=>Ze(f))}function kn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function _o(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function hn(e,...t){if(!_o(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function ur(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Pi(e,t){hn(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const wo=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),kr=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Oe=(e,t)=>e<<32-t|e>>>t,Cn=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,xo=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function Ln(e){for(let t=0;t<e.length;t++)e[t]=xo(e[t])}function vo(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function dn(e){return typeof e=="string"&&(e=vo(e)),hn(e),e}let ki=class{clone(){return this._cloneInto()}};function Ci(e){const t=n=>e().update(dn(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function Eo(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const i=BigInt(32),a=BigInt(4294967295),f=Number(r>>i&a),u=Number(r&a),l=n?4:0,b=n?0:4;e.setUint32(t+l,f,n),e.setUint32(t+b,u,n)}const Bo=(e,t,r)=>e&t^~e&r,So=(e,t,r)=>e&t^e&r^t&r;class Ao extends ki{constructor(t,r,n,i){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=kr(this.buffer)}update(t){ur(this);const{view:r,buffer:n,blockLen:i}=this;t=dn(t);const a=t.length;for(let f=0;f<a;){const u=Math.min(i-this.pos,a-f);if(u===i){const l=kr(t);for(;i<=a-f;f+=i)this.process(l,f);continue}n.set(t.subarray(f,f+u),this.pos),this.pos+=u,f+=u,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ur(this),Pi(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:a}=this;let{pos:f}=this;r[f++]=128,this.buffer.subarray(f).fill(0),this.padOffset>i-f&&(this.process(n,0),f=0);for(let m=f;m<i;m++)r[m]=0;Eo(n,i-8,BigInt(this.length*8),a),this.process(n,0);const u=kr(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const b=l/4,g=this.get();if(b>g.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<b;m++)u.setUint32(4*m,g[m],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:a,destroyed:f,pos:u}=this;return t.length=i,t.pos=u,t.finished=a,t.destroyed=f,i%r&&t.buffer.set(n),t}}const Io=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ye=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Je=new Uint32Array(64);class Ro extends Ao{constructor(){super(64,32,8,!1),this.A=Ye[0]|0,this.B=Ye[1]|0,this.C=Ye[2]|0,this.D=Ye[3]|0,this.E=Ye[4]|0,this.F=Ye[5]|0,this.G=Ye[6]|0,this.H=Ye[7]|0}get(){const{A:t,B:r,C:n,D:i,E:a,F:f,G:u,H:l}=this;return[t,r,n,i,a,f,u,l]}set(t,r,n,i,a,f,u,l){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=a|0,this.F=f|0,this.G=u|0,this.H=l|0}process(t,r){for(let m=0;m<16;m++,r+=4)Je[m]=t.getUint32(r,!1);for(let m=16;m<64;m++){const v=Je[m-15],A=Je[m-2],B=Oe(v,7)^Oe(v,18)^v>>>3,k=Oe(A,17)^Oe(A,19)^A>>>10;Je[m]=k+Je[m-7]+B+Je[m-16]|0}let{A:n,B:i,C:a,D:f,E:u,F:l,G:b,H:g}=this;for(let m=0;m<64;m++){const v=Oe(u,6)^Oe(u,11)^Oe(u,25),A=g+v+Bo(u,l,b)+Io[m]+Je[m]|0,k=(Oe(n,2)^Oe(n,13)^Oe(n,22))+So(n,i,a)|0;g=b,b=l,l=u,u=f+A|0,f=a,a=i,i=n,n=A+k|0}n=n+this.A|0,i=i+this.B|0,a=a+this.C|0,f=f+this.D|0,u=u+this.E|0,l=l+this.F|0,b=b+this.G|0,g=g+this.H|0,this.set(n,i,a,f,u,l,b,g)}roundClean(){Je.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const To=Ci(()=>new Ro);function Po(e,t){return To(qt(e,{strict:!1})?vi(e):e)}function ko(e){const{commitment:t,version:r=1}=e,n=e.to??(typeof t=="string"?"hex":"bytes"),i=Po(t);return i.set([r],0),n==="bytes"?i:Ze(i)}function Co(e){const{commitments:t,version:r}=e,n=e.to??(typeof t[0]=="string"?"hex":"bytes"),i=[];for(const a of t)i.push(ko({commitment:a,to:n,version:r}));return i}const On=6,Li=32,pn=4096,Oi=Li*pn,Fn=Oi*On-1-1*pn*On,Fi=1;class Lo extends Q{constructor({maxSize:t,size:r}){super("Blob size is too large.",{metaMessages:[`Max: ${t} bytes`,`Given: ${r} bytes`],name:"BlobSizeTooLargeError"})}}class Ui extends Q{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}class Oo extends Q{constructor({hash:t,size:r}){super(`Versioned hash "${t}" size is invalid.`,{metaMessages:["Expected: 32",`Received: ${r}`],name:"InvalidVersionedHashSizeError"})}}class Fo extends Q{constructor({hash:t,version:r}){super(`Versioned hash "${t}" version is invalid.`,{metaMessages:[`Expected: ${Fi}`,`Received: ${r}`],name:"InvalidVersionedHashVersionError"})}}function Uo(e){const t=e.to??(typeof e.data=="string"?"hex":"bytes"),r=typeof e.data=="string"?ot(e.data):e.data,n=xt(r);if(!n)throw new Ui;if(n>Fn)throw new Lo({maxSize:Fn,size:n});const i=[];let a=!0,f=0;for(;a;){const u=Si(new Uint8Array(Oi));let l=0;for(;l<pn;){const b=r.slice(f,f+(Li-1));if(u.pushByte(0),u.pushBytes(b),b.length<31){u.pushByte(128),a=!1;break}l++,f+=31}i.push(u)}return t==="bytes"?i.map(u=>u.bytes):i.map(u=>Ze(u.bytes))}function Mo(e){const{data:t,kzg:r,to:n}=e,i=e.blobs??Uo({data:t,to:n}),a=e.commitments??Ri({blobs:i,kzg:r,to:n}),f=e.proofs??Ti({blobs:i,commitments:a,kzg:r,to:n}),u=[];for(let l=0;l<i.length;l++)u.push({blob:i[l],commitment:a[l],proof:f[l]});return u}function No(e){if(!e||e.length===0)return[];const t=[];for(const r of e){const{contractAddress:n,chainId:i,nonce:a,...f}=r;t.push([W(i),n,a?W(a):"0x",...Kt({},f)])}return t}class ft extends Q{constructor({address:t}){super(`Address "${t}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}class yr extends Q{constructor({chainId:t}){super(typeof t=="number"?`Chain ID "${t}" is invalid.`:"Chain ID is invalid.",{name:"InvalidChainIdError"})}}class gr extends Q{constructor({cause:t,maxFeePerGas:r}={}){super(`The fee cap (\`maxFeePerGas\`${r?` = ${Jr(r)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:t,name:"FeeCapTooHighError"})}}Object.defineProperty(gr,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class Mi extends Q{constructor({cause:t,maxPriorityFeePerGas:r,maxFeePerGas:n}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${r?` = ${Jr(r)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${n?` = ${Jr(n)} gwei`:""}).`].join(`
`),{cause:t,name:"TipAboveFeeCapError"})}}Object.defineProperty(Mi,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class Ni extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const r=super.get(t);return super.has(t)&&r!==void 0&&(this.delete(t),super.set(t,r)),r}set(t,r){if(super.set(t,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const tr=BigInt(2**32-1),Un=BigInt(32);function Do(e,t=!1){return t?{h:Number(e&tr),l:Number(e>>Un&tr)}:{h:Number(e>>Un&tr)|0,l:Number(e&tr)|0}}function $o(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:a,l:f}=Do(e[i],t);[r[i],n[i]]=[a,f]}return[r,n]}const Ho=(e,t,r)=>e<<r|t>>>32-r,zo=(e,t,r)=>t<<r|e>>>32-r,jo=(e,t,r)=>t<<r-32|e>>>64-r,Go=(e,t,r)=>e<<r-32|t>>>64-r,Di=[],$i=[],Hi=[],Wo=BigInt(0),Ct=BigInt(1),qo=BigInt(2),Vo=BigInt(7),Ko=BigInt(256),Yo=BigInt(113);for(let e=0,t=Ct,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Di.push(2*(5*n+r)),$i.push((e+1)*(e+2)/2%64);let i=Wo;for(let a=0;a<7;a++)t=(t<<Ct^(t>>Vo)*Yo)%Ko,t&qo&&(i^=Ct<<(Ct<<BigInt(a))-Ct);Hi.push(i)}const[Jo,Xo]=$o(Hi,!0),Mn=(e,t,r)=>r>32?jo(e,t,r):Ho(e,t,r),Nn=(e,t,r)=>r>32?Go(e,t,r):zo(e,t,r);function Qo(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let f=0;f<10;f++)r[f]=e[f]^e[f+10]^e[f+20]^e[f+30]^e[f+40];for(let f=0;f<10;f+=2){const u=(f+8)%10,l=(f+2)%10,b=r[l],g=r[l+1],m=Mn(b,g,1)^r[u],v=Nn(b,g,1)^r[u+1];for(let A=0;A<50;A+=10)e[f+A]^=m,e[f+A+1]^=v}let i=e[2],a=e[3];for(let f=0;f<24;f++){const u=$i[f],l=Mn(i,a,u),b=Nn(i,a,u),g=Di[f];i=e[g],a=e[g+1],e[g]=l,e[g+1]=b}for(let f=0;f<50;f+=10){for(let u=0;u<10;u++)r[u]=e[f+u];for(let u=0;u<10;u++)e[f+u]^=~r[(u+2)%10]&r[(u+4)%10]}e[0]^=Jo[n],e[1]^=Xo[n]}r.fill(0)}class bn extends ki{constructor(t,r,n,i=!1,a=24){if(super(),this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,kn(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=wo(this.state)}keccak(){Cn||Ln(this.state32),Qo(this.state32,this.rounds),Cn||Ln(this.state32),this.posOut=0,this.pos=0}update(t){ur(this);const{blockLen:r,state:n}=this;t=dn(t);const i=t.length;for(let a=0;a<i;){const f=Math.min(r-this.pos,i-a);for(let u=0;u<f;u++)n[this.pos++]^=t[a++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:r,pos:n,blockLen:i}=this;t[n]^=r,r&128&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){ur(this,!1),hn(t),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,a=t.length;i<a;){this.posOut>=n&&this.keccak();const f=Math.min(n-this.posOut,a-i);t.set(r.subarray(this.posOut,this.posOut+f),i),this.posOut+=f,i+=f}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return kn(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Pi(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:r,suffix:n,outputLen:i,rounds:a,enableXOF:f}=this;return t||(t=new bn(r,n,i,f,a)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=a,t.suffix=n,t.outputLen=i,t.enableXOF=f,t.destroyed=this.destroyed,t}}const Zo=(e,t,r)=>Ci(()=>new bn(t,e,r)),ea=Zo(1,136,256/8);function ta(e,t){return ea(qt(e,{strict:!1})?vi(e):e)}const Cr=new Ni(8192);function ra(e,t){if(Cr.has(`${e}.${t}`))return Cr.get(`${e}.${t}`);const r=e.substring(2).toLowerCase(),n=ta(Ei(r)),i=r.split("");for(let f=0;f<40;f+=2)n[f>>1]>>4>=8&&i[f]&&(i[f]=i[f].toUpperCase()),(n[f>>1]&15)>=8&&i[f+1]&&(i[f+1]=i[f+1].toUpperCase());const a=`0x${i.join("")}`;return Cr.set(`${e}.${t}`,a),a}const na=/^0x[a-fA-F0-9]{40}$/,Lr=new Ni(8192);function ut(e,t){const{strict:r=!0}=t??{},n=`${e}.${r}`;if(Lr.has(n))return Lr.get(n);const i=na.test(e)?e.toLowerCase()===e?!0:r?ra(e)===e:!0:!1;return Lr.set(n,i),i}function ia(e,t,r,{strict:n}={}){return qt(e,{strict:!1})?oa(e,t,r,{strict:n}):sa(e,t,r,{strict:n})}function zi(e,t,r){if(xt(e)!==r-t)throw new js({offset:r,position:"end",size:xt(e)})}function sa(e,t,r,{strict:n}={}){const i=e.slice(t,r);return n&&zi(i,t,r),i}function oa(e,t,r,{strict:n}={}){const i=`0x${e.replace("0x","").slice(t*2,r*2)}`;return n&&zi(i,t,r),i}function aa(e){const{authorizationList:t}=e;if(t)for(const r of t){const{contractAddress:n,chainId:i}=r;if(!ut(n))throw new ft({address:n});if(i<=0)throw new yr({chainId:i})}yn(e)}function fa(e){const{blobVersionedHashes:t}=e;if(t){if(t.length===0)throw new Ui;for(const r of t){const n=xt(r),i=fr(ia(r,0,1));if(n!==32)throw new Oo({hash:r,size:n});if(i!==Fi)throw new Fo({hash:r,version:i})}}yn(e)}function yn(e){const{chainId:t,maxPriorityFeePerGas:r,maxFeePerGas:n,to:i}=e;if(t<=0)throw new yr({chainId:t});if(i&&!ut(i))throw new ft({address:i});if(n&&n>ln)throw new gr({maxFeePerGas:n});if(r&&n&&r>n)throw new Mi({maxFeePerGas:n,maxPriorityFeePerGas:r})}function ua(e){const{chainId:t,maxPriorityFeePerGas:r,gasPrice:n,maxFeePerGas:i,to:a}=e;if(t<=0)throw new yr({chainId:t});if(a&&!ut(a))throw new ft({address:a});if(r||i)throw new Q("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid EIP-2930 Transaction attribute.");if(n&&n>ln)throw new gr({maxFeePerGas:n})}function ca(e){const{chainId:t,maxPriorityFeePerGas:r,gasPrice:n,maxFeePerGas:i,to:a}=e;if(a&&!ut(a))throw new ft({address:a});if(typeof t<"u"&&t<=0)throw new yr({chainId:t});if(r||i)throw new Q("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid Legacy Transaction attribute.");if(n&&n>ln)throw new gr({maxFeePerGas:n})}function la(e){if(e.type)return e.type;if(typeof e.authorizationList<"u")return"eip7702";if(typeof e.blobs<"u"||typeof e.blobVersionedHashes<"u"||typeof e.maxFeePerBlobGas<"u"||typeof e.sidecars<"u")return"eip4844";if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")return"eip1559";if(typeof e.gasPrice<"u")return typeof e.accessList<"u"?"eip2930":"legacy";throw new go({transaction:e})}function mr(e){if(!e||e.length===0)return[];const t=[];for(let r=0;r<e.length;r++){const{address:n,storageKeys:i}=e[r];for(let a=0;a<i.length;a++)if(i[a].length-2!==64)throw new mo({storageKey:i[a]});if(!ut(n,{strict:!1}))throw new ft({address:n});t.push([n,i])}return t}function ha(e,t){const r=la(e);return r==="eip1559"?ba(e,t):r==="eip2930"?ya(e,t):r==="eip4844"?pa(e,t):r==="eip7702"?da(e,t):ga(e,t)}function da(e,t){const{authorizationList:r,chainId:n,gas:i,nonce:a,to:f,value:u,maxFeePerGas:l,maxPriorityFeePerGas:b,accessList:g,data:m}=e;aa(e);const v=mr(g),A=No(r);return Vt(["0x04",at([W(n),a?W(a):"0x",b?W(b):"0x",l?W(l):"0x",i?W(i):"0x",f??"0x",u?W(u):"0x",m??"0x",v,A,...Kt(e,t)])])}function pa(e,t){const{chainId:r,gas:n,nonce:i,to:a,value:f,maxFeePerBlobGas:u,maxFeePerGas:l,maxPriorityFeePerGas:b,accessList:g,data:m}=e;fa(e);let v=e.blobVersionedHashes,A=e.sidecars;if(e.blobs&&(typeof v>"u"||typeof A>"u")){const O=typeof e.blobs[0]=="string"?e.blobs:e.blobs.map(S=>Ze(S)),L=e.kzg,U=Ri({blobs:O,kzg:L});if(typeof v>"u"&&(v=Co({commitments:U})),typeof A>"u"){const S=Ti({blobs:O,commitments:U,kzg:L});A=Mo({blobs:O,commitments:U,proofs:S})}}const B=mr(g),k=[W(r),i?W(i):"0x",b?W(b):"0x",l?W(l):"0x",n?W(n):"0x",a??"0x",f?W(f):"0x",m??"0x",B,u?W(u):"0x",v??[],...Kt(e,t)],T=[],C=[],F=[];if(A)for(let O=0;O<A.length;O++){const{blob:L,commitment:U,proof:S}=A[O];T.push(L),C.push(U),F.push(S)}return Vt(["0x03",at(A?[k,T,C,F]:k)])}function ba(e,t){const{chainId:r,gas:n,nonce:i,to:a,value:f,maxFeePerGas:u,maxPriorityFeePerGas:l,accessList:b,data:g}=e;yn(e);const m=mr(b),v=[W(r),i?W(i):"0x",l?W(l):"0x",u?W(u):"0x",n?W(n):"0x",a??"0x",f?W(f):"0x",g??"0x",m,...Kt(e,t)];return Vt(["0x02",at(v)])}function ya(e,t){const{chainId:r,gas:n,data:i,nonce:a,to:f,value:u,accessList:l,gasPrice:b}=e;ua(e);const g=mr(l),m=[W(r),a?W(a):"0x",b?W(b):"0x",n?W(n):"0x",f??"0x",u?W(u):"0x",i??"0x",g,...Kt(e,t)];return Vt(["0x01",at(m)])}function ga(e,t){const{chainId:r=0,gas:n,data:i,nonce:a,to:f,value:u,gasPrice:l}=e;ca(e);let b=[a?W(a):"0x",l?W(l):"0x",n?W(n):"0x",f??"0x",u?W(u):"0x",i??"0x"];if(t){const g=(()=>{if(t.v>=35n)return(t.v-35n)/2n>0?t.v:27n+(t.v===35n?0n:1n);if(r>0)return BigInt(r*2)+BigInt(35n+t.v-27n);const A=27n+(t.v===27n?0n:1n);if(t.v!==A)throw new yo({v:t.v});return A})(),m=ar(t.r),v=ar(t.s);b=[...b,W(g),m==="0x00"?"0x":m,v==="0x00"?"0x":v]}else r>0&&(b=[...b,W(r),"0x","0x"]);return at(b)}function Kt(e,t){const r=t??e,{v:n,yParity:i}=r;if(typeof r.r>"u")return[];if(typeof r.s>"u")return[];if(typeof n>"u"&&typeof i>"u")return[];const a=ar(r.r),f=ar(r.s);return[typeof i=="number"?i?W(1):"0x":n===0n?"0x":n===1n?W(1):n===27n?"0x":W(1),a==="0x00"?"0x":a,f==="0x00"?"0x":f]}const ma={gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}},_a={block:ro({format(e){var r;return{transactions:(r=e.transactions)==null?void 0:r.map(n=>{if(typeof n=="string")return n;const i=cn(n);return i.typeHex==="0x7e"&&(i.isSystemTx=n.isSystemTx,i.mint=n.mint?mt(n.mint):void 0,i.sourceHash=n.sourceHash,i.type="deposit"),i}),stateRoot:e.stateRoot}}}),transaction:Zs({format(e){const t={};return e.type==="0x7e"&&(t.isSystemTx=e.isSystemTx,t.mint=e.mint?mt(e.mint):void 0,t.sourceHash=e.sourceHash,t.type="deposit"),t}}),transactionReceipt:oo({format(e){return{l1GasPrice:e.l1GasPrice?mt(e.l1GasPrice):null,l1GasUsed:e.l1GasUsed?mt(e.l1GasUsed):null,l1Fee:e.l1Fee?mt(e.l1Fee):null,l1FeeScalar:e.l1FeeScalar?Number(e.l1FeeScalar):null}}})};function wa(e,t){return Ea(e)?va(e):ha(e,t)}const xa={transaction:wa};function va(e){Ba(e);const{sourceHash:t,data:r,from:n,gas:i,isSystemTx:a,mint:f,to:u,value:l}=e,b=[t,n,u??"0x",f?W(f):"0x",l?W(l):"0x",i?W(i):"0x",a?"0x1":"0x",r??"0x"];return Vt(["0x7e",at(b)])}function Ea(e){return e.type==="deposit"||typeof e.sourceHash<"u"}function Ba(e){const{from:t,to:r}=e;if(t&&!ut(t))throw new ft({address:t});if(r&&!ut(r))throw new ft({address:r})}const Dn={contracts:ma,formatters:_a,serializers:xa},Sa=Wt({id:42161,name:"Arbitrum One",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://arb1.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://arbiscan.io",apiUrl:"https://api.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7654707}}}),Aa=Wt({id:421614,name:"Arbitrum Sepolia",nativeCurrency:{name:"Arbitrum Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia-rollup.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://sepolia.arbiscan.io",apiUrl:"https://api-sepolia.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:81930}},testnet:!0}),Lt=11155111,Ia=Wt({...Dn,id:84532,network:"base-sepolia",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}},contracts:{...Dn.contracts,disputeGameFactory:{[Lt]:{address:"0xd6E6dBf4F7EA0ac412fD8b65ED297e64BB7a06E1"}},l2OutputOracle:{[Lt]:{address:"0x84457ca9D0163FbC4bbfe4Dfbb20ba46e48DF254"}},portal:{[Lt]:{address:"0x49f53e41452c74589e85ca1677426ba426459e85",blockCreated:4446677}},l1StandardBridge:{[Lt]:{address:"0xfd0Bf71F60660E2f608ed56e1659C450eB113120",blockCreated:4446677}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1059647}},testnet:!0,sourceId:Lt}),Ra=Wt({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://cloudflare-eth.com"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}}),Ta=Wt({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://rpc2.sepolia.org"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xc8Af999e38273D658BE1b921b88A9Ddf005769cC",blockCreated:5317080}},testnet:!0});function Xr(e){return typeof e=="string"&&(e=Buffer.from(e,"hex")),e.length===32?e:e.subarray(1,33)}function yt(e,t){if(!e)throw new Error(t)}function Pa(e){return Buffer.concat([Uint8Array.from([192]),ka(e)])}function ka(e){const t=Rn.encodingLength(e.length),r=Buffer.allocUnsafe(t);return Rn.encode(e.length,r),Buffer.concat([r,e])}function Ca(e,t){if(e.compare(t)>0){const r=e;e=t,t=r}return[e,t]}const Ot=e=>e.length===64?e:e.slice(2),La=e=>{if(!e)return!1;try{const t=Buffer.from(e,"hex");return st.isPoint(t)}catch{return!1}},Oa={...Ta,rpcUrls:{default:{http:["https://ethereum-sepolia-rpc.publicnode.com"]}}},ji={ethereum:Ra,ethereum_arbitrum:Sa,ethereum_sepolia:Oa,arbitrum_sepolia:Aa,ethereum_localnet:J.EthereumLocalnet,arbitrum_localnet:J.ArbitrumLocalnet,base_sepolia:Ia},Fa=async(e,t)=>{var n;const r=ji[e];if(r)try{if(r.id===((n=t.chain)==null?void 0:n.id))return P.Ok({message:"Already on the network",walletClient:t});await t.switchChain({id:r.id});const i=He.createWalletClient({account:t.account,chain:r,transport:He.custom(window.ethereum)});return P.Ok({message:"Switched chain",walletClient:i})}catch(i){if(Ua(i))try{await t.addChain({chain:r});const a=He.createWalletClient({account:t.account,chain:r,transport:He.custom(window.ethereum)});return P.Ok({message:"Added network",walletClient:a})}catch{return P.Err("Failed to add network")}else return P.Err("Failed to switch network")}else return P.Err("Chain not supported")},Ua=e=>typeof e=="object"&&e!==null&&"code"in e&&e.code===4902,Gi=(e,t,r,n)=>e+":"+t.toLowerCase()+"::"+r+":"+n.toLowerCase();function Ma(e,t){if(!e)return!1;const r=t==="mainnet"?ue.networks.bitcoin:ue.networks.testnet;ue.initEccLib(st);try{return ue.address.toOutputScript(e,r),!0}catch{return!1}}var re=(e=>(e.Created="Created",e.Matched="Matched",e.InitiateDetected="InitiateDetected",e.Initiated="Initiated",e.CounterPartyInitiateDetected="CounterPartyInitiateDetected",e.CounterPartyInitiated="CounterPartyInitiated",e.RedeemDetected="RedeemDetected",e.Redeemed="Redeemed",e.CounterPartyRedeemDetected="CounterPartyRedeemDetected",e.CounterPartyRedeemed="CounterPartyRedeemed",e.Completed="Completed",e.CounterPartySwapExpired="CounterPartySwapExpired",e.Expired="Expired",e.RefundDetected="RefundDetected",e.Refunded="Refunded",e.CounterPartyRefundDetected="CounterPartyRefundDetected",e.CounterPartyRefunded="CounterPartyRefunded",e.Cancelled="Cancelled",e.DeadLineExceeded="DeadLineExceeded",e))(re||{}),ne=(e=>(e.Idle="Idle",e.InitiateDetected="InitiateDetected",e.Initiated="Initiated",e.RedeemDetected="RedeemDetected",e.Redeemed="Redeemed",e.RefundDetected="RefundDetected",e.Refunded="Refunded",e.Expired="Expired",e))(ne||{});const gn=(e,t,r)=>{const n=Qr(e.source_swap,t),i=Qr(e.destination_swap,r);if(i===ne.RedeemDetected)return re.RedeemDetected;if(n===ne.Redeemed)return re.CounterPartyRedeemed;if(n===ne.RedeemDetected)return re.CounterPartyRedeemDetected;if(i===ne.Redeemed)return re.Redeemed;if(n===ne.Refunded)return re.Refunded;if(n===ne.RefundDetected)return re.RefundDetected;if(i===ne.Expired)return re.CounterPartySwapExpired;if(n===ne.Expired)return re.Expired;if(i===ne.Refunded)return re.CounterPartyRefunded;if(i===ne.RefundDetected)return re.CounterPartyRefundDetected;const a=Number(e.create_order.additional_data.deadline);return i===ne.Initiated?re.CounterPartyInitiated:i===ne.InitiateDetected?re.CounterPartyInitiateDetected:zt(a,12)?re.DeadLineExceeded:n===ne.Initiated?re.Initiated:zt(a,1)?re.DeadLineExceeded:n===ne.InitiateDetected?re.InitiateDetected:re.Matched},Qr=(e,t)=>{if(e.redeem_tx_hash)return Number(e.redeem_block_number)?ne.Redeemed:ne.RedeemDetected;if(e.refund_tx_hash)return Number(e.refund_block_number)?ne.Refunded:ne.RefundDetected;if(Number(e.initiate_block_number)){const r=Number(e.initiate_block_number)+e.timelock;if(t>r)return ne.Expired}return e.initiate_tx_hash?Number(e.initiate_block_number)?ne.Initiated:ne.InitiateDetected:ne.Idle},Na=(e,t,r)=>{const n=gn(e,t,r);return mn(n)},mn=e=>{switch(e){case re.Matched:return ce.Initiate;case re.CounterPartyInitiated:case re.CounterPartyInitiateDetected:case re.RedeemDetected:return ce.Redeem;case re.Expired:return ce.Refund;default:return ce.Idle}},zt=(e,t=0)=>{const r=Date.now(),n=e*1e3+t*36e5;return r>=n},Wi=e=>e.filter(t=>{const{source_swap:r,create_order:n}=t,{initiate_tx_hash:i,initiate_block_number:a}=r,{deadline:f}=n.additional_data;return i&&Number(a)?!0:i&&!Number(a)?!zt(Number(f),12):i?!0:!zt(Number(f),1)}),Da=[{inputs:[{internalType:"address",name:"token_",type:"address"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidShortString",type:"error"},{inputs:[{internalType:"string",name:"str",type:"string"}],name:"StringTooLong",type:"error"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"orderID",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"secretHash",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Initiated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"orderID",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"secretHash",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"secret",type:"bytes"}],name:"Redeemed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"orderID",type:"bytes32"}],name:"Refunded",type:"event"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"redeemer",type:"address"},{internalType:"uint256",name:"timelock",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes32",name:"secretHash",type:"bytes32"}],name:"initiate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"redeemer",type:"address"},{internalType:"uint256",name:"timelock",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes32",name:"secretHash",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"initiateWithSignature",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"orderID",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"instantRefund",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address",name:"redeemer",type:"address"},{internalType:"uint256",name:"expiry",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes32",name:"secretHash",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],internalType:"struct HTLC.InitWithSig[]",name:"inits",type:"tuple[]"},{components:[{internalType:"bytes32",name:"orderID",type:"bytes32"},{internalType:"bytes",name:"secret",type:"bytes"}],internalType:"struct HTLC.Redeem[]",name:"redeems",type:"tuple[]"},{components:[{internalType:"bytes32",name:"orderID",type:"bytes32"}],internalType:"struct HTLC.Refund[]",name:"refunds",type:"tuple[]"}],name:"multicall",outputs:[{internalType:"bool[]",name:"results",type:"bool[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"orders",outputs:[{internalType:"bool",name:"isFulfilled",type:"bool"},{internalType:"address",name:"initiator",type:"address"},{internalType:"address",name:"redeemer",type:"address"},{internalType:"uint256",name:"initiatedAt",type:"uint256"},{internalType:"uint256",name:"timelock",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"orderID",type:"bytes32"},{internalType:"bytes",name:"secret",type:"bytes"}],name:"redeem",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"orderID",type:"bytes32"}],name:"refund",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"token",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"}];class qi{constructor(t,r,n){this.url=new we.Url("/relayer",r),this.auth=n,this.order=t}async init(t){if(!t.account)return P.Err("No account found");if(t.account.address.toLowerCase()!==this.order.source_swap.initiator.toLowerCase())return P.Err("Account address and order initiator mismatch");const{create_order:r,source_swap:n}=this.order;if(!n.amount||!n.redeemer||!r.timelock||!r.secret_hash)return P.Err("Invalid order");const i=we.with0x(r.secret_hash),a=BigInt(r.timelock),f=we.with0x(n.redeemer),u=BigInt(n.amount);try{const l=await this.auth.getToken();if(l.error)return P.Err(l.error);const b=He.getContract({address:we.with0x(this.order.source_swap.asset),abi:Da,client:t}),g=await b.read.token(),m=await we.checkAllowanceAndApprove(Number(u),g,this.order.source_swap.asset,t);if(m.error)return P.Err(m.error);const v=await b.read.eip712Domain(),A=await t.signTypedData({account:t.account,domain:{name:v[1],version:v[2],chainId:Number(v[3]),verifyingContract:v[4]},types:{Initiate:[{name:"redeemer",type:"address"},{name:"timelock",type:"uint256"},{name:"amount",type:"uint256"},{name:"secretHash",type:"bytes32"}]},primaryType:"Initiate",message:{redeemer:f,timelock:a,amount:u,secretHash:i}}),B=await P.Fetcher.post(this.url.endpoint("initiate"),{body:JSON.stringify({order_id:r.create_id,signature:A,perform_on:"Source"}),headers:{Authorization:we.Authorization(l.val),"Content-Type":"application/json"}});return B.error?P.Err(B.error):B.result?P.Ok(B.result):P.Err("Init: No result found")}catch(l){return console.log("init error :",l),P.Err(String(l))}}async redeem(t,r){try{const n=await this.auth.getToken();if(n.error)return P.Err(n.error);const i=await P.Fetcher.post(this.url.endpoint("redeem"),{body:JSON.stringify({order_id:t,secret:P.trim0x(r),perform_on:"Destination"}),headers:{Authorization:we.Authorization(n.val),"Content-Type":"application/json"}});return i.error?P.Err(i.error):i.result?P.Ok(i.result):P.Err("Redeem: No result found")}catch(n){return P.Err(String(n))}}}const $a=Buffer.from("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","hex"),Ha=Buffer.from("483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8","hex"),za=Buffer.concat([$a,Ha]),ja=Buffer.from("0250929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0","hex"),$n={failedToCreateInternalPubkey:"failed to create internal pubkey",failedToTweakPubkey:"failed to tweak pubkey"};function Ga(){const e=gi.crypto.sha256(Buffer.from("GardenHTLC","utf-8")),t=st.pointMultiply(Buffer.concat([Buffer.from("04","hex"),za]),e);if(!t)throw new Error($n.failedToCreateInternalPubkey);const r=st.pointAdd(ja,t);if(!r)throw new Error($n.failedToCreateInternalPubkey);return Xr(Buffer.from(r))}const me={secretMismatch:"invalid secret",secretHashLenMismatch:"secret hash should be 32 bytes",pubkeyLenMismatch:"pubkey should be 32 bytes",zeroOrNegativeExpiry:"expiry should be greater than 0",htlcAddressGenerationFailed:"failed to generate htlc address",notFunded:"address not funded",noCounterpartySigs:"counterparty signatures are required",counterPartySigNotFound:e=>"counterparty signature not found for utxo "+e,invalidCounterpartySigForUTXO:e=>"invalid counterparty signature for utxo "+e,htlcNotExpired:e=>`HTLC not expired, need more ${e} blocks`,controlBlockGenerationFailed:"failed to generate control block",invalidLeaf:"invalid leaf"},rr=192;ue.initEccLib(st);class cr{constructor(t,r,n,i,a,f,u,l){this.secretHash=n,this.redeemerPubkey=i,this.initiatorPubkey=a,this.expiry=f,this.signer=t,this.network=u,this.internalPubkey=Ga(),this.initiateAmount=r,this.utxoHashes=l}static async from(t,r,n,i,a,f,u){n=n.startsWith("0x")?n.slice(2):n,yt(n.length===64,me.secretHashLenMismatch),yt(i.length===64||i.length===66,`initiator ${me.pubkeyLenMismatch}`),yt(a.length===64||a.length===66,`redeemer ${me.pubkeyLenMismatch}`),yt(f>0,me.zeroOrNegativeExpiry);const l=await t.getNetwork();return new cr(t,r,n,Xr(a).toString("hex"),Xr(i).toString("hex"),f,l,u)}address(){const{address:t}=ue.payments.p2tr({internalPubkey:this.internalPubkey,network:this.network,scriptTree:this.leaves()});if(!t)throw new Error(me.htlcAddressGenerationFailed);return t}id(){return this.address()}async _buildRawTx(t,r){const n=new ue.Transaction;n.version=2;const i=this.address(),a=await this.signer.getProvider();let f=[];if(this.utxoHashes&&this.utxoHashes.length>0)for(const l of this.utxoHashes){const b=await a.getTransaction(l);for(let g=0;g<b.vout.length;g++){const m=b.vout[g];m.scriptpubkey_address===i&&f.push({txid:b.txid,vout:g,value:m.value,status:{confirmed:!1}})}}else f=await a.getUTXOs(i);const u=f.reduce((l,b)=>l+b.value,0);if(u===0)throw new Error(`${i} ${me.notFunded}`);for(let l=0;l<f.length;l++)n.addInput(Buffer.from(f[l].txid,"hex").reverse(),f[l].vout);return r??(r=await a.suggestFee(i,u,In.Urgency.MEDIUM)),n.addOutput(ue.address.toOutputScript(t,this.network),u-r),{tx:n,usedUtxos:f}}async buildRawTx(t){return await this._buildRawTx(await this.signer.getAddress(),t)}getOutputScript(){return ue.address.toOutputScript(this.address(),this.network)}async init(t){return t??(t=await(await this.signer.getProvider()).suggestFee(await this.signer.getAddress(),this.initiateAmount,In.Urgency.MEDIUM)),await this.signer.send(this.address(),this.initiateAmount,t)}async instantRefund(t,r){yt(t.length>0,me.noCounterpartySigs);const{tx:n,usedUtxos:i}=await this.buildRawTx(r);for(const m of i)if(!t.find(v=>v.utxo===m.txid))throw new Error(me.counterPartySigNotFound(m.txid));const a=this.getOutputScript(),f=ue.Transaction.SIGHASH_DEFAULT,u=this.leafHash(2),l=i.map(m=>m.value),b=Or(a,i.length);for(let m=0;m<n.ins.length;m++){const v=n.hashForWitnessV1(m,b,l,f,u);if(!st.verifySchnorr(v,Buffer.from(this.redeemerPubkey,"hex"),Buffer.from(t[m].sig,"hex")))throw new Error(me.invalidCounterpartySigForUTXO(t[m].utxo));const A=await this.signer.signSchnorr(v),B=Buffer.from(n.ins[m].hash).reverse().toString("hex"),k=t.find(T=>T.utxo===B);if(!k)throw new Error(me.counterPartySigNotFound(B));n.setWitness(m,[Buffer.from(k.sig,"hex"),A,this.instantRefundLeaf(),this.generateControlBlockFor(2)])}return await(await this.signer.getProvider()).broadcast(n.toHex())}async redeem(t,r,n){yt(ue.crypto.sha256(Buffer.from(t,"hex")).toString("hex")===this.secretHash,me.secretMismatch);const{tx:i,usedUtxos:a}=await this._buildRawTx(r??await this.signer.getAddress(),n),f=this.leafHash(1),u=a.map(m=>m.value),l=Or(this.getOutputScript(),a.length),b=ue.Transaction.SIGHASH_DEFAULT;for(let m=0;m<i.ins.length;m++){const v=i.hashForWitnessV1(m,l,u,b,f),A=await this.signer.signSchnorr(v);i.setWitness(m,[A,Buffer.from(t,"hex"),this.redeemLeaf(),this.generateControlBlockFor(1)])}return await(await this.signer.getProvider()).broadcast(i.toHex())}async refund(t,r){const{tx:n,usedUtxos:i}=await this._buildRawTx(t??await this.signer.getAddress(),r),[a,f]=await this.canRefund(i);if(!a)throw new Error(me.htlcNotExpired(f));const u=this.leafHash(0),l=i.map(v=>v.value),b=Or(this.getOutputScript(),i.length),g=ue.Transaction.SIGHASH_DEFAULT;for(let v=0;v<n.ins.length;v++){n.ins[v].sequence=this.expiry;const A=n.hashForWitnessV1(v,b,l,g,u),B=await this.signer.signSchnorr(A);n.setWitness(v,[B,this.refundLeaf(),this.generateControlBlockFor(0)])}return await(await this.signer.getProvider()).broadcast(n.toHex())}async canRefund(t){const n=await(await this.signer.getProvider()).getLatestTip();for(const i of t){let a=0;if(i.status.confirmed&&i.status.block_height+this.expiry>n?a=i.status.block_height+this.expiry-n+1:i.status.confirmed||(a=this.expiry+1),a>0)return[!1,a]}return[!0,0]}generateControlBlockFor(t){let r;switch(t){case 1:r=this.redeemLeaf();break;case 0:r=this.refundLeaf();break;case 2:r=this.instantRefundLeaf();break;default:throw new Error(me.invalidLeaf)}const n=ue.payments.p2tr({internalPubkey:this.internalPubkey,network:this.network,scriptTree:this.leaves(),redeem:{output:r,redeemVersion:rr}});if(!n.witness)throw new Error(me.controlBlockGenerationFailed);return n.witness[n.witness.length-1]}leafHash(t){let r=this.redeemLeaf();return t===0&&(r=this.refundLeaf()),t===2&&(r=this.instantRefundLeaf()),ue.crypto.taggedHash("TapLeaf",Pa(r))}refundLeaf(){return ue.script.fromASM(`
			${ue.script.number.encode(this.expiry).toString("hex")}
			OP_CHECKSEQUENCEVERIFY
			OP_DROP
			${this.initiatorPubkey}	
			OP_CHECKSIG
			`.trim().replace(/\s+/g," "))}redeemLeaf(){return ue.script.fromASM(`
			OP_SHA256
			${this.secretHash}
			OP_EQUALVERIFY
			${this.redeemerPubkey}
			OP_CHECKSIG
			`.trim().replace(/\s+/g," "))}instantRefundLeaf(){return ue.script.fromASM(`
			${this.initiatorPubkey}
			OP_CHECKSIG
			${this.redeemerPubkey}
			OP_CHECKSIGADD
			OP_2
			OP_NUMEQUAL
			`.trim().replace(/\s+/g," "))}leaves(){return[{version:rr,output:this.redeemLeaf()},[{version:rr,output:this.refundLeaf()},{version:rr,output:this.instantRefundLeaf()}]]}generateMerkleProofFor(t){const r=this.leafHash(1),n=this.leafHash(2),i=this.leafHash(0);switch(t){case 1:{const a=Ca(i,n);return[ue.crypto.taggedHash("TapBranch",Buffer.concat(a))]}case 0:return[n,r];case 2:return[i,r];default:throw new Error(me.invalidLeaf)}}}function Or(e,t){const r=[];for(let n=0;n<t;n++)r.push(e);return r}class Wa{constructor(){this.cache={}}set(t,r,n,i){const a={txHash:n,timeStamp:Date.now(),btcRedeemUTXO:i};this.cache[`${r}_${t.create_order.create_id}`]=a}get(t,r){return this.cache[`${r}_${t.create_order.create_id}`]||null}remove(t,r){delete this.cache[`${r}_${t.create_order.create_id}`]}}class qa{constructor(t){if(this.eventListeners=new Map,this.getOrderThreshold=20,this.useRelay=!0,this.orderBook=new J.Orderbook({url:t.orderbookURl,walletClient:t.wallets.evmWallet,auth:t.auth}),this.quote=t.quote,this.secretManager=t.secretManager,this.wallets=t.wallets,this.orderbookUrl=t.orderbookURl,this.auth=t.auth,this.orderExecutorCache=new Wa,!t.wallets.evmWallet.account)throw new Error("Account not found in evmWallet");this.evmAddress=t.wallets.evmWallet.account.address,this.blockNumberFetcher=t.blockNumberFetcher}setUseRelay(t){this.useRelay=t}async swap(t){const r=await this.validateAndFillParams(t);if(r.error)return P.Err(r.error);const{sendAddress:n,receiveAddress:i,timelock:a}=r.val,f=await this.orderBook.getOrdersCount(this.evmAddress);if(f.error)return P.Err(f.error);const u=f.val+1,l=this.secretManager.generateSecret(u);if(l.error)return P.Err(l.error);const{strategyId:b,btcAddress:g}=t.additionalData,m={strategy_id:b,...g&&{bitcoin_optional_recipient:g}},v={source_chain:t.fromAsset.chain,destination_chain:t.toAsset.chain,source_asset:t.fromAsset.atomicSwapAddress,destination_asset:t.toAsset.atomicSwapAddress,initiator_source_address:n,initiator_destination_address:i,source_amount:t.sendAmount,destination_amount:t.receiveAmount,fee:"1",nonce:u.toString(),timelock:a,secret_hash:P.trim0x(l.val.secretHash),min_destination_confirmations:t.minDestinationConfirmations??0,additional_data:m},A=await this.quote.getAttestedQuote(v);if(A.error)return P.Err(A.error);const B=await this.orderBook.createOrder(A.val);if(B.error)return P.Err(B.error);const k=await this.pollOrder(B.val);return k.error?P.Err(k.error):P.Ok(k.val)}async validateAndFillParams(t){if(t.fromAsset.chain===t.toAsset.chain&&t.fromAsset.atomicSwapAddress===t.toAsset.atomicSwapAddress)return P.Err("Source and destination assets cannot be the same");if(J.isMainnet(t.fromAsset.chain)&&!J.isMainnet(t.toAsset.chain)||!J.isMainnet(t.fromAsset.chain)&&J.isMainnet(t.toAsset.chain))return P.Err("Both assets should be on the same network (either mainnet or testnet)");if(J.isBitcoin(t.fromAsset.chain)||J.isBitcoin(t.toAsset.chain)){if(!this.wallets.btcWallet)return P.Err("btcWallet is required for bitcoin chain. Please provide btcWallet in the constructor");if(!t.additionalData.btcAddress)return P.Err("btcAddress in additionalData is required for bitcoin chain")}const r=await this.getAddresses(t.fromAsset.chain);if(r.error)return P.Err(r.error);const n=await this.getAddresses(t.toAsset.chain);if(n.error)return P.Err(n.error);const i=this.validateAmount(t.sendAmount);if(i.error)return P.Err(i.error);const a=this.validateAmount(t.receiveAmount);if(a.error)return P.Err(a.error);if(i<a)return P.Err("Send amount should be greater than receive amount");const f=this.getTimelock(t.fromAsset.chain);return f?P.Ok({sendAddress:r.val,receiveAddress:n.val,timelock:t.timelock??f}):P.Err("Unsupported chain for timelock")}async getAddresses(t){var n;switch(J.getBlockchainType(t)){case J.BlockchainType.EVM:return this.wallets.evmWallet.account?P.Ok(this.wallets.evmWallet.account.address):P.Err("EVM Wallet not found");case J.BlockchainType.Bitcoin:{const i=await((n=this.wallets.btcWallet)==null?void 0:n.getPublicKey());return!i||!La(i)?P.Err("Invalid btc public key"):P.Ok(Ot(i))}default:return P.Err("Unsupported chain")}}validateAmount(t){if(t==null||t.includes("."))return P.Err("Invalid amount ",t);const r=new $s(t);return!r.isInteger()||r.isNaN()||r.lt(0)||r.isLessThanOrEqualTo(0)?P.Err("Invalid amount ",t):P.Ok(r)}getTimelock(t){switch(J.getBlockchainType(t)){case J.BlockchainType.EVM:return or.evm;case J.BlockchainType.Bitcoin:return or.btc;default:return}}async pollOrder(t){let r=await this.orderBook.getOrder(t,!0),n=0;for(;n<this.getOrderThreshold;){if(await we.sleep(1e3),n++,r.error){if(!r.error.includes("result is undefined"))return P.Err(r.error)}else if(r.val&&r.val.create_order.create_id.toLowerCase()===t.toLowerCase())return P.Ok(r.val);r=await this.orderBook.getOrder(t,!0)}return P.Err(`Order not found, createOrder id: ${t}`)}async execute(t=5e3){return await this.orderBook.subscribeToOrders(!0,t,async r=>{const n=Wi(r.data),i=await this.assignOrderStatus(n);this.emit("onPendingOrdersChanged",i);for(let a=0;a<i.length;a++){const f=i[a];switch(mn(f.status)){case ce.Redeem:{const l=this.secretManager.generateSecret(Number(f.create_order.nonce));if(l.error){this.emit("error",f,l.error);return}switch(J.getBlockchainType(f.destination_swap.chain)){case J.BlockchainType.EVM:{await this.evmRedeem(f,l.val.secret);break}case J.BlockchainType.Bitcoin:{const b=this.getWallet(f.destination_swap.chain);if(b.error){this.emit("error",f,b.error);return}await this.btcRedeem(b.val,f,l.val.secret);break}default:this.emit("error",f,"Unsupported chain: "+f.destination_swap.chain)}break}case ce.Refund:{switch(J.getBlockchainType(f.source_swap.chain)){case J.BlockchainType.EVM:{this.emit("error",f,"EVM refund is automatically done by relay service");break}case J.BlockchainType.Bitcoin:{const l=this.getWallet(f.source_swap.chain);if(l.error){this.emit("error",f,l.error);return}await this.btcRefund(l.val,f);break}default:this.emit("error",f,"Unsupported chain: "+f.source_swap.chain)}break}}}},{per_page:500},!0)}async evmRedeem(t,r){if(this.emit("log",t.create_order.create_id,"executing evm redeem"),this.orderExecutorCache.get(t,ce.Redeem)){this.emit("log",t.create_order.create_id,"already redeemed");return}const a=await new qi(t,this.orderbookUrl,this.auth).redeem(t.create_order.create_id,r);if(a.error){this.emit("error",t,a.error),a.error.includes("Order already redeemed")&&this.orderExecutorCache.set(t,ce.Redeem,t.destination_swap.redeem_tx_hash);return}this.orderExecutorCache.set(t,ce.Redeem,a.val),this.emit("success",t,ce.Redeem,a.val)}async btcRedeem(t,r,n){var u,l;const i=this.orderExecutorCache.get(r,ce.Redeem),a=(u=r.destination_swap.initiate_tx_hash.split(",").at(-1))==null?void 0:u.split(":").at(0);if(!a){this.emit("error",r,"Failed to get initiate_tx_hash");return}let f=!1;if(i)if(i.btcRedeemUTXO&&i.btcRedeemUTXO!==a)f=!0,this.emit("log",r.create_order.create_id,"rbf btc redeem");else{this.emit("log",r.create_order.create_id,"btcRedeem: already redeemed");return}else if(r.destination_swap.redeem_tx_hash&&!Number(r.destination_swap.redeem_block_number))try{const b=await(await t.getProvider()).getTransaction(r.destination_swap.redeem_tx_hash);let g=!1;for(const m of b.vin)if(m.txid===a){g=!0;break}if(g){this.orderExecutorCache.set(r,ce.Redeem,r.destination_swap.redeem_tx_hash,a),this.emit("log",r.create_order.create_id,"already a valid redeem");return}f=!0}catch(b){if(b.message.includes("Transaction not found"))f=!0;else{this.emit("error",r,"Failed to get redeem tx: "+b);return}}this.emit("log",r.create_order.create_id,"executing btc redeem");try{const g=await(await cr.from(t,Number(r.destination_swap.amount),r.create_order.secret_hash,Ot(r.destination_swap.initiator),Ot(r.destination_swap.redeemer),r.destination_swap.timelock,f?[a]:[])).redeem(P.trim0x(n),(l=r.create_order.additional_data)==null?void 0:l.bitcoin_optional_recipient);f?this.emit("log",r.create_order.create_id,"rbf: btc redeem success"):this.emit("success",r,ce.Redeem,g),this.orderExecutorCache.set(r,ce.Redeem,g,a)}catch(b){this.emit("error",r,"Failed btc redeem: "+b)}}async btcRefund(t,r){var n;if(!this.orderExecutorCache.get(r,ce.Refund)){this.emit("log",r.create_order.create_id,"executing btc refund");try{const a=await(await cr.from(t,Number(r.source_swap.amount),r.create_order.secret_hash,Ot(r.source_swap.initiator),Ot(r.source_swap.redeemer),r.source_swap.timelock)).refund((n=r.create_order.additional_data)==null?void 0:n.bitcoin_optional_recipient);this.orderExecutorCache.set(r,ce.Refund,a),this.emit("success",r,ce.Refund,a)}catch(i){this.emit("error",r,"Failed btc refund: "+i)}}}getWallet(t){switch(J.getBlockchainType(t)){case J.BlockchainType.EVM:return P.Ok(this.wallets.evmWallet);case J.BlockchainType.Bitcoin:return P.Ok(this.wallets.btcWallet);default:return P.Err("Unsupported chain for wallet")}}emit(t,...r){(this.eventListeners.get(t)??[]).forEach(i=>{i(...r)})}on(t,r){const n=this.eventListeners.get(t)??[];n.push(r),this.eventListeners.set(t,n)}off(t,r){const n=this.eventListeners.get(t)??[],i=n.indexOf(r);i!==-1&&n.splice(i,1)}async fetchCurrentBlockNumbers(t,r){if(!r||!r.source||!r.destination)return P.Err("Provide wallets to fetch the current block number");const n=J.isBitcoin(t.source_swap.chain)?await we.fetchBitcoinBlockNumber(await r.source.getProvider()):await we.fetchEVMBlockNumber(r.source);if(n.error)return P.Err(n.error);const i=J.isBitcoin(t.destination_swap.chain)?await we.fetchBitcoinBlockNumber(await r.destination.getProvider()):await we.fetchEVMBlockNumber(r.destination);return i.error?P.Err(i.error):P.Ok({source:n.val,destination:i.val})}async assignOrderStatus(t){var i;const r=await((i=this.blockNumberFetcher)==null?void 0:i.fetchBlockNumbers()),n=[];for(let a=0;a<t.length;a++){const f=t[a],u=f.source_swap.chain,l=f.destination_swap.chain,b=this.getWallet(u),g=this.getWallet(l);if(b.error||g.error||!b.val||!g.val){this.emit("error",f,"Source or Destination Wallet not found while executing order");continue}let m=r==null?void 0:r.val[u],v=r==null?void 0:r.val[l];if(!m||!v){const B=await this.fetchCurrentBlockNumbers(f,{source:b.val,destination:g.val});if(B.error){this.emit("error",f,"Error while fetching CurrentBlockNumbers: "+B.error);continue}m=B.val.source,v=B.val.destination}const A=gn(f,m,v);n.push({...f,status:A})}return n}}class Va{constructor(t,r){this.url=new we.Url("/blocknumber/"+r,t)}async fetchBlockNumbers(){try{const t=await P.Fetcher.get(this.url);return P.Ok(t)}catch(t){return P.Err("Failed to fetch block numbers",t)}}}var Qe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ka(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ya(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Vi={},vt={},Et={};Object.defineProperty(Et,"__esModule",{value:!0});Et.testnet=Et.bitcoin=void 0;Et.bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};Et.testnet={messagePrefix:`Bitcoin Signed Message:
`,bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239};var Ki={},jt={Array:function(e){return e!=null&&e.constructor===Array},Boolean:function(e){return typeof e=="boolean"},Function:function(e){return typeof e=="function"},Nil:function(e){return e==null},Number:function(e){return typeof e=="number"},Object:function(e){return typeof e=="object"},String:function(e){return typeof e=="string"},"":function(){return!0}};jt.Null=jt.Nil;for(var Hn in jt)jt[Hn].toJSON=(function(e){return e}).bind(null,Hn);var _n=jt,it=_n;function Yi(e){return e.name||e.toString().match(/function (.*?)\s*\(/)[1]}function wn(e){return it.Nil(e)?"":Yi(e.constructor)}function Ja(e){return it.Function(e)?"":it.String(e)?JSON.stringify(e):e&&it.Object(e)?"":e}function xn(e,t){Error.captureStackTrace&&Error.captureStackTrace(e,t)}function lr(e){return it.Function(e)?e.toJSON?e.toJSON():Yi(e):it.Array(e)?"Array":e&&it.Object(e)?"Object":e!==void 0?e:""}function Ji(e,t,r){var n=Ja(t);return"Expected "+lr(e)+", got"+(r!==""?" "+r:"")+(n!==""?" "+n:"")}function ze(e,t,r){r=r||wn(t),this.message=Ji(e,t,r),xn(this,ze),this.__type=e,this.__value=t,this.__valueTypeName=r}ze.prototype=Object.create(Error.prototype);ze.prototype.constructor=ze;function Xa(e,t,r,n,i){var a='" of type ';return t==="key"&&(a='" with key type '),Ji('property "'+lr(r)+a+lr(e),n,i)}function _t(e,t,r,n,i){e?(i=i||wn(n),this.message=Xa(e,r,t,n,i)):this.message='Unexpected property "'+t+'"',xn(this,ze),this.__label=r,this.__property=t,this.__type=e,this.__value=n,this.__valueTypeName=i}_t.prototype=Object.create(Error.prototype);_t.prototype.constructor=ze;function Qa(e,t){return new ze(e,{},t)}function Za(e,t,r){return e instanceof _t?(t=t+"."+e.__property,e=new _t(e.__type,t,e.__label,e.__value,e.__valueTypeName)):e instanceof ze&&(e=new _t(e.__type,t,r,e.__value,e.__valueTypeName)),xn(e),e}var Xi={TfTypeError:ze,TfPropertyTypeError:_t,tfCustomError:Qa,tfSubError:Za,tfJSON:lr,getValueTypeName:wn},Fr,zn;function ef(){if(zn)return Fr;zn=1;var e=_n,t=Xi;function r(S){return Buffer.isBuffer(S)}function n(S){return typeof S=="string"&&/^([0-9a-f]{2})+$/i.test(S)}function i(S,z){var N=S.toJSON();function $(oe){if(!S(oe))return!1;if(oe.length===z)return!0;throw t.tfCustomError(N+"(Length: "+z+")",N+"(Length: "+oe.length+")")}return $.toJSON=function(){return N},$}var a=i.bind(null,e.Array),f=i.bind(null,r),u=i.bind(null,n),l=i.bind(null,e.String);function b(S,z,N){N=N||e.Number;function $(oe,Pe){return N(oe,Pe)&&oe>S&&oe<z}return $.toJSON=function(){return`${N.toJSON()} between [${S}, ${z}]`},$}var g=Math.pow(2,53)-1;function m(S){return typeof S=="number"&&isFinite(S)}function v(S){return S<<24>>24===S}function A(S){return S<<16>>16===S}function B(S){return(S|0)===S}function k(S){return typeof S=="number"&&S>=-g&&S<=g&&Math.floor(S)===S}function T(S){return(S&255)===S}function C(S){return(S&65535)===S}function F(S){return S>>>0===S}function O(S){return typeof S=="number"&&S>=0&&S<=g&&Math.floor(S)===S}var L={ArrayN:a,Buffer:r,BufferN:f,Finite:m,Hex:n,HexN:u,Int8:v,Int16:A,Int32:B,Int53:k,Range:b,StringN:l,UInt8:T,UInt16:C,UInt32:F,UInt53:O};for(var U in L)L[U].toJSON=(function(S){return S}).bind(null,U);return Fr=L,Fr}var Yt=Xi,he=_n,De=Yt.tfJSON,Qi=Yt.TfTypeError,Zi=Yt.TfPropertyTypeError,Ft=Yt.tfSubError,tf=Yt.getValueTypeName,$e={arrayOf:function(t,r){t=Fe(t),r=r||{};function n(i,a){return!he.Array(i)||he.Nil(i)||r.minLength!==void 0&&i.length<r.minLength||r.maxLength!==void 0&&i.length>r.maxLength||r.length!==void 0&&i.length!==r.length?!1:i.every(function(f,u){try{return xe(t,f,a)}catch(l){throw Ft(l,u)}})}return n.toJSON=function(){var i="["+De(t)+"]";return r.length!==void 0?i+="{"+r.length+"}":(r.minLength!==void 0||r.maxLength!==void 0)&&(i+="{"+(r.minLength===void 0?0:r.minLength)+","+(r.maxLength===void 0?1/0:r.maxLength)+"}"),i},n},maybe:function e(t){t=Fe(t);function r(n,i){return he.Nil(n)||t(n,i,e)}return r.toJSON=function(){return"?"+De(t)},r},map:function(t,r){t=Fe(t),r&&(r=Fe(r));function n(i,a){if(!he.Object(i)||he.Nil(i))return!1;for(var f in i){try{r&&xe(r,f,a)}catch(l){throw Ft(l,f,"key")}try{var u=i[f];xe(t,u,a)}catch(l){throw Ft(l,f)}}return!0}return r?n.toJSON=function(){return"{"+De(r)+": "+De(t)+"}"}:n.toJSON=function(){return"{"+De(t)+"}"},n},object:function(t){var r={};for(var n in t)r[n]=Fe(t[n]);function i(a,f){if(!he.Object(a)||he.Nil(a))return!1;var u;try{for(u in r){var l=r[u],b=a[u];xe(l,b,f)}}catch(g){throw Ft(g,u)}if(f){for(u in a)if(!r[u])throw new Zi(void 0,u)}return!0}return i.toJSON=function(){return De(r)},i},anyOf:function(){var t=[].slice.call(arguments).map(Fe);function r(n,i){return t.some(function(a){try{return xe(a,n,i)}catch{return!1}})}return r.toJSON=function(){return t.map(De).join("|")},r},allOf:function(){var t=[].slice.call(arguments).map(Fe);function r(n,i){return t.every(function(a){try{return xe(a,n,i)}catch{return!1}})}return r.toJSON=function(){return t.map(De).join(" & ")},r},quacksLike:function(t){function r(n){return t===tf(n)}return r.toJSON=function(){return t},r},tuple:function(){var t=[].slice.call(arguments).map(Fe);function r(n,i){return he.Nil(n)||he.Nil(n.length)||i&&n.length!==t.length?!1:t.every(function(a,f){try{return xe(a,n[f],i)}catch(u){throw Ft(u,f)}})}return r.toJSON=function(){return"("+t.map(De).join(", ")+")"},r},value:function(t){function r(n){return n===t}return r.toJSON=function(){return t},r}};$e.oneOf=$e.anyOf;function Fe(e){if(he.String(e))return e[0]==="?"?$e.maybe(e.slice(1)):he[e]||$e.quacksLike(e);if(e&&he.Object(e)){if(he.Array(e)){if(e.length!==1)throw new TypeError("Expected compile() parameter of type Array of length 1");return $e.arrayOf(e[0])}return $e.object(e)}else if(he.Function(e))return e;return $e.value(e)}function xe(e,t,r,n){if(he.Function(e)){if(e(t,r))return!0;throw new Qi(n||e,t)}return xe(Fe(e),t,r)}for(var Xe in he)xe[Xe]=he[Xe];for(Xe in $e)xe[Xe]=$e[Xe];var jn=ef();for(Xe in jn)xe[Xe]=jn[Xe];xe.compile=Fe;xe.TfTypeError=Qi;xe.TfPropertyTypeError=Zi;var rf=xe;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.maybe=e.Boolean=e.Array=e.Buffer256bit=e.Network=e.typeforce=void 0,e.typeforce=rf,e.Network=e.typeforce.compile({messagePrefix:e.typeforce.oneOf(e.typeforce.Buffer,e.typeforce.String),bip32:{public:e.typeforce.UInt32,private:e.typeforce.UInt32},pubKeyHash:e.typeforce.UInt8,scriptHash:e.typeforce.UInt8,wif:e.typeforce.UInt8}),e.Buffer256bit=e.typeforce.BufferN(32),e.Array=e.typeforce.Array,e.Boolean=e.typeforce.Boolean,e.maybe=e.typeforce.maybe})(Ki);var Zr={exports:{}},en={exports:{}},It={},_r={};_r.byteLength=of;_r.toByteArray=ff;_r.fromByteArray=lf;var Ue=[],Re=[],nf=typeof Uint8Array<"u"?Uint8Array:Array,Ur="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var gt=0,sf=Ur.length;gt<sf;++gt)Ue[gt]=Ur[gt],Re[Ur.charCodeAt(gt)]=gt;Re[45]=62;Re[95]=63;function es(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function of(e){var t=es(e),r=t[0],n=t[1];return(r+n)*3/4-n}function af(e,t,r){return(t+r)*3/4-r}function ff(e){var t,r=es(e),n=r[0],i=r[1],a=new nf(af(e,n,i)),f=0,u=i>0?n-4:n,l;for(l=0;l<u;l+=4)t=Re[e.charCodeAt(l)]<<18|Re[e.charCodeAt(l+1)]<<12|Re[e.charCodeAt(l+2)]<<6|Re[e.charCodeAt(l+3)],a[f++]=t>>16&255,a[f++]=t>>8&255,a[f++]=t&255;return i===2&&(t=Re[e.charCodeAt(l)]<<2|Re[e.charCodeAt(l+1)]>>4,a[f++]=t&255),i===1&&(t=Re[e.charCodeAt(l)]<<10|Re[e.charCodeAt(l+1)]<<4|Re[e.charCodeAt(l+2)]>>2,a[f++]=t>>8&255,a[f++]=t&255),a}function uf(e){return Ue[e>>18&63]+Ue[e>>12&63]+Ue[e>>6&63]+Ue[e&63]}function cf(e,t,r){for(var n,i=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(e[a+2]&255),i.push(uf(n));return i.join("")}function lf(e){for(var t,r=e.length,n=r%3,i=[],a=16383,f=0,u=r-n;f<u;f+=a)i.push(cf(e,f,f+a>u?u:f+a));return n===1?(t=e[r-1],i.push(Ue[t>>2]+Ue[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],i.push(Ue[t>>10]+Ue[t>>4&63]+Ue[t<<2&63]+"=")),i.join("")}var vn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */vn.read=function(e,t,r,n,i){var a,f,u=i*8-n-1,l=(1<<u)-1,b=l>>1,g=-7,m=r?i-1:0,v=r?-1:1,A=e[t+m];for(m+=v,a=A&(1<<-g)-1,A>>=-g,g+=u;g>0;a=a*256+e[t+m],m+=v,g-=8);for(f=a&(1<<-g)-1,a>>=-g,g+=n;g>0;f=f*256+e[t+m],m+=v,g-=8);if(a===0)a=1-b;else{if(a===l)return f?NaN:(A?-1:1)*(1/0);f=f+Math.pow(2,n),a=a-b}return(A?-1:1)*f*Math.pow(2,a-n)};vn.write=function(e,t,r,n,i,a){var f,u,l,b=a*8-i-1,g=(1<<b)-1,m=g>>1,v=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=n?0:a-1,B=n?1:-1,k=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,f=g):(f=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-f))<1&&(f--,l*=2),f+m>=1?t+=v/l:t+=v*Math.pow(2,1-m),t*l>=2&&(f++,l/=2),f+m>=g?(u=0,f=g):f+m>=1?(u=(t*l-1)*Math.pow(2,i),f=f+m):(u=t*Math.pow(2,m-1)*Math.pow(2,i),f=0));i>=8;e[r+A]=u&255,A+=B,u/=256,i-=8);for(f=f<<i|u,b+=i;b>0;e[r+A]=f&255,A+=B,f/=256,b-=8);e[r+A-B]|=k*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=_r,r=vn,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=F,e.INSPECT_MAX_BYTES=50;const i=2147483647;e.kMaxLength=i,u.TYPED_ARRAY_SUPPORT=a(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const c=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(c,s),c.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function f(c){if(c>i)throw new RangeError('The value "'+c+'" is invalid for option "size"');const s=new Uint8Array(c);return Object.setPrototypeOf(s,u.prototype),s}function u(c,s,o){if(typeof c=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(c)}return l(c,s,o)}u.poolSize=8192;function l(c,s,o){if(typeof c=="string")return v(c,s);if(ArrayBuffer.isView(c))return B(c);if(c==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(Ae(c,ArrayBuffer)||c&&Ae(c.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ae(c,SharedArrayBuffer)||c&&Ae(c.buffer,SharedArrayBuffer)))return k(c,s,o);if(typeof c=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const h=c.valueOf&&c.valueOf();if(h!=null&&h!==c)return u.from(h,s,o);const y=T(c);if(y)return y;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof c[Symbol.toPrimitive]=="function")return u.from(c[Symbol.toPrimitive]("string"),s,o);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}u.from=function(c,s,o){return l(c,s,o)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function b(c){if(typeof c!="number")throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}function g(c,s,o){return b(c),c<=0?f(c):s!==void 0?typeof o=="string"?f(c).fill(s,o):f(c).fill(s):f(c)}u.alloc=function(c,s,o){return g(c,s,o)};function m(c){return b(c),f(c<0?0:C(c)|0)}u.allocUnsafe=function(c){return m(c)},u.allocUnsafeSlow=function(c){return m(c)};function v(c,s){if((typeof s!="string"||s==="")&&(s="utf8"),!u.isEncoding(s))throw new TypeError("Unknown encoding: "+s);const o=O(c,s)|0;let h=f(o);const y=h.write(c,s);return y!==o&&(h=h.slice(0,y)),h}function A(c){const s=c.length<0?0:C(c.length)|0,o=f(s);for(let h=0;h<s;h+=1)o[h]=c[h]&255;return o}function B(c){if(Ae(c,Uint8Array)){const s=new Uint8Array(c);return k(s.buffer,s.byteOffset,s.byteLength)}return A(c)}function k(c,s,o){if(s<0||c.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<s+(o||0))throw new RangeError('"length" is outside of buffer bounds');let h;return s===void 0&&o===void 0?h=new Uint8Array(c):o===void 0?h=new Uint8Array(c,s):h=new Uint8Array(c,s,o),Object.setPrototypeOf(h,u.prototype),h}function T(c){if(u.isBuffer(c)){const s=C(c.length)|0,o=f(s);return o.length===0||c.copy(o,0,0,s),o}if(c.length!==void 0)return typeof c.length!="number"||rt(c.length)?f(0):A(c);if(c.type==="Buffer"&&Array.isArray(c.data))return A(c.data)}function C(c){if(c>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return c|0}function F(c){return+c!=c&&(c=0),u.alloc(+c)}u.isBuffer=function(s){return s!=null&&s._isBuffer===!0&&s!==u.prototype},u.compare=function(s,o){if(Ae(s,Uint8Array)&&(s=u.from(s,s.offset,s.byteLength)),Ae(o,Uint8Array)&&(o=u.from(o,o.offset,o.byteLength)),!u.isBuffer(s)||!u.isBuffer(o))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===o)return 0;let h=s.length,y=o.length;for(let x=0,E=Math.min(h,y);x<E;++x)if(s[x]!==o[x]){h=s[x],y=o[x];break}return h<y?-1:y<h?1:0},u.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(s,o){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(s.length===0)return u.alloc(0);let h;if(o===void 0)for(o=0,h=0;h<s.length;++h)o+=s[h].length;const y=u.allocUnsafe(o);let x=0;for(h=0;h<s.length;++h){let E=s[h];if(Ae(E,Uint8Array))x+E.length>y.length?(u.isBuffer(E)||(E=u.from(E)),E.copy(y,x)):Uint8Array.prototype.set.call(y,E,x);else if(u.isBuffer(E))E.copy(y,x);else throw new TypeError('"list" argument must be an Array of Buffers');x+=E.length}return y};function O(c,s){if(u.isBuffer(c))return c.length;if(ArrayBuffer.isView(c)||Ae(c,ArrayBuffer))return c.byteLength;if(typeof c!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);const o=c.length,h=arguments.length>2&&arguments[2]===!0;if(!h&&o===0)return 0;let y=!1;for(;;)switch(s){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":return V(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o*2;case"hex":return o>>>1;case"base64":return Tt(c).length;default:if(y)return h?-1:V(c).length;s=(""+s).toLowerCase(),y=!0}}u.byteLength=O;function L(c,s,o){let h=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((o===void 0||o>this.length)&&(o=this.length),o<=0)||(o>>>=0,s>>>=0,o<=s))return"";for(c||(c="utf8");;)switch(c){case"hex":return Ce(this,s,o);case"utf8":case"utf-8":return ve(this,s,o);case"ascii":return ke(this,s,o);case"latin1":case"binary":return We(this,s,o);case"base64":return fe(this,s,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return qe(this,s,o);default:if(h)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),h=!0}}u.prototype._isBuffer=!0;function U(c,s,o){const h=c[s];c[s]=c[o],c[o]=h}u.prototype.swap16=function(){const s=this.length;if(s%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let o=0;o<s;o+=2)U(this,o,o+1);return this},u.prototype.swap32=function(){const s=this.length;if(s%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let o=0;o<s;o+=4)U(this,o,o+3),U(this,o+1,o+2);return this},u.prototype.swap64=function(){const s=this.length;if(s%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let o=0;o<s;o+=8)U(this,o,o+7),U(this,o+1,o+6),U(this,o+2,o+5),U(this,o+3,o+4);return this},u.prototype.toString=function(){const s=this.length;return s===0?"":arguments.length===0?ve(this,0,s):L.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(s){if(!u.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s?!0:u.compare(this,s)===0},u.prototype.inspect=function(){let s="";const o=e.INSPECT_MAX_BYTES;return s=this.toString("hex",0,o).replace(/(.{2})/g,"$1 ").trim(),this.length>o&&(s+=" ... "),"<Buffer "+s+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(s,o,h,y,x){if(Ae(s,Uint8Array)&&(s=u.from(s,s.offset,s.byteLength)),!u.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(o===void 0&&(o=0),h===void 0&&(h=s?s.length:0),y===void 0&&(y=0),x===void 0&&(x=this.length),o<0||h>s.length||y<0||x>this.length)throw new RangeError("out of range index");if(y>=x&&o>=h)return 0;if(y>=x)return-1;if(o>=h)return 1;if(o>>>=0,h>>>=0,y>>>=0,x>>>=0,this===s)return 0;let E=x-y,q=h-o;const ie=Math.min(E,q),te=this.slice(y,x),se=s.slice(o,h);for(let Y=0;Y<ie;++Y)if(te[Y]!==se[Y]){E=te[Y],q=se[Y];break}return E<q?-1:q<E?1:0};function S(c,s,o,h,y){if(c.length===0)return-1;if(typeof o=="string"?(h=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),o=+o,rt(o)&&(o=y?0:c.length-1),o<0&&(o=c.length+o),o>=c.length){if(y)return-1;o=c.length-1}else if(o<0)if(y)o=0;else return-1;if(typeof s=="string"&&(s=u.from(s,h)),u.isBuffer(s))return s.length===0?-1:z(c,s,o,h,y);if(typeof s=="number")return s=s&255,typeof Uint8Array.prototype.indexOf=="function"?y?Uint8Array.prototype.indexOf.call(c,s,o):Uint8Array.prototype.lastIndexOf.call(c,s,o):z(c,[s],o,h,y);throw new TypeError("val must be string, number or Buffer")}function z(c,s,o,h,y){let x=1,E=c.length,q=s.length;if(h!==void 0&&(h=String(h).toLowerCase(),h==="ucs2"||h==="ucs-2"||h==="utf16le"||h==="utf-16le")){if(c.length<2||s.length<2)return-1;x=2,E/=2,q/=2,o/=2}function ie(se,Y){return x===1?se[Y]:se.readUInt16BE(Y*x)}let te;if(y){let se=-1;for(te=o;te<E;te++)if(ie(c,te)===ie(s,se===-1?0:te-se)){if(se===-1&&(se=te),te-se+1===q)return se*x}else se!==-1&&(te-=te-se),se=-1}else for(o+q>E&&(o=E-q),te=o;te>=0;te--){let se=!0;for(let Y=0;Y<q;Y++)if(ie(c,te+Y)!==ie(s,Y)){se=!1;break}if(se)return te}return-1}u.prototype.includes=function(s,o,h){return this.indexOf(s,o,h)!==-1},u.prototype.indexOf=function(s,o,h){return S(this,s,o,h,!0)},u.prototype.lastIndexOf=function(s,o,h){return S(this,s,o,h,!1)};function N(c,s,o,h){o=Number(o)||0;const y=c.length-o;h?(h=Number(h),h>y&&(h=y)):h=y;const x=s.length;h>x/2&&(h=x/2);let E;for(E=0;E<h;++E){const q=parseInt(s.substr(E*2,2),16);if(rt(q))return E;c[o+E]=q}return E}function $(c,s,o,h){return pt(V(s,c.length-o),c,o,h)}function oe(c,s,o,h){return pt(Ke(s),c,o,h)}function Pe(c,s,o,h){return pt(Tt(s),c,o,h)}function Ge(c,s,o,h){return pt(dt(s,c.length-o),c,o,h)}u.prototype.write=function(s,o,h,y){if(o===void 0)y="utf8",h=this.length,o=0;else if(h===void 0&&typeof o=="string")y=o,h=this.length,o=0;else if(isFinite(o))o=o>>>0,isFinite(h)?(h=h>>>0,y===void 0&&(y="utf8")):(y=h,h=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const x=this.length-o;if((h===void 0||h>x)&&(h=x),s.length>0&&(h<0||o<0)||o>this.length)throw new RangeError("Attempt to write outside buffer bounds");y||(y="utf8");let E=!1;for(;;)switch(y){case"hex":return N(this,s,o,h);case"utf8":case"utf-8":return $(this,s,o,h);case"ascii":case"latin1":case"binary":return oe(this,s,o,h);case"base64":return Pe(this,s,o,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ge(this,s,o,h);default:if(E)throw new TypeError("Unknown encoding: "+y);y=(""+y).toLowerCase(),E=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function fe(c,s,o){return s===0&&o===c.length?t.fromByteArray(c):t.fromByteArray(c.slice(s,o))}function ve(c,s,o){o=Math.min(c.length,o);const h=[];let y=s;for(;y<o;){const x=c[y];let E=null,q=x>239?4:x>223?3:x>191?2:1;if(y+q<=o){let ie,te,se,Y;switch(q){case 1:x<128&&(E=x);break;case 2:ie=c[y+1],(ie&192)===128&&(Y=(x&31)<<6|ie&63,Y>127&&(E=Y));break;case 3:ie=c[y+1],te=c[y+2],(ie&192)===128&&(te&192)===128&&(Y=(x&15)<<12|(ie&63)<<6|te&63,Y>2047&&(Y<55296||Y>57343)&&(E=Y));break;case 4:ie=c[y+1],te=c[y+2],se=c[y+3],(ie&192)===128&&(te&192)===128&&(se&192)===128&&(Y=(x&15)<<18|(ie&63)<<12|(te&63)<<6|se&63,Y>65535&&Y<1114112&&(E=Y))}}E===null?(E=65533,q=1):E>65535&&(E-=65536,h.push(E>>>10&1023|55296),E=56320|E&1023),h.push(E),y+=q}return tt(h)}const Ee=4096;function tt(c){const s=c.length;if(s<=Ee)return String.fromCharCode.apply(String,c);let o="",h=0;for(;h<s;)o+=String.fromCharCode.apply(String,c.slice(h,h+=Ee));return o}function ke(c,s,o){let h="";o=Math.min(c.length,o);for(let y=s;y<o;++y)h+=String.fromCharCode(c[y]&127);return h}function We(c,s,o){let h="";o=Math.min(c.length,o);for(let y=s;y<o;++y)h+=String.fromCharCode(c[y]);return h}function Ce(c,s,o){const h=c.length;(!s||s<0)&&(s=0),(!o||o<0||o>h)&&(o=h);let y="";for(let x=s;x<o;++x)y+=Pt[c[x]];return y}function qe(c,s,o){const h=c.slice(s,o);let y="";for(let x=0;x<h.length-1;x+=2)y+=String.fromCharCode(h[x]+h[x+1]*256);return y}u.prototype.slice=function(s,o){const h=this.length;s=~~s,o=o===void 0?h:~~o,s<0?(s+=h,s<0&&(s=0)):s>h&&(s=h),o<0?(o+=h,o<0&&(o=0)):o>h&&(o=h),o<s&&(o=s);const y=this.subarray(s,o);return Object.setPrototypeOf(y,u.prototype),y};function Z(c,s,o){if(c%1!==0||c<0)throw new RangeError("offset is not uint");if(c+s>o)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(s,o,h){s=s>>>0,o=o>>>0,h||Z(s,o,this.length);let y=this[s],x=1,E=0;for(;++E<o&&(x*=256);)y+=this[s+E]*x;return y},u.prototype.readUintBE=u.prototype.readUIntBE=function(s,o,h){s=s>>>0,o=o>>>0,h||Z(s,o,this.length);let y=this[s+--o],x=1;for(;o>0&&(x*=256);)y+=this[s+--o]*x;return y},u.prototype.readUint8=u.prototype.readUInt8=function(s,o){return s=s>>>0,o||Z(s,1,this.length),this[s]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(s,o){return s=s>>>0,o||Z(s,2,this.length),this[s]|this[s+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(s,o){return s=s>>>0,o||Z(s,2,this.length),this[s]<<8|this[s+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(s,o){return s=s>>>0,o||Z(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+this[s+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(s,o){return s=s>>>0,o||Z(s,4,this.length),this[s]*16777216+(this[s+1]<<16|this[s+2]<<8|this[s+3])},u.prototype.readBigUInt64LE=Ie(function(s){s=s>>>0,I(s,"offset");const o=this[s],h=this[s+7];(o===void 0||h===void 0)&&M(s,this.length-8);const y=o+this[++s]*2**8+this[++s]*2**16+this[++s]*2**24,x=this[++s]+this[++s]*2**8+this[++s]*2**16+h*2**24;return BigInt(y)+(BigInt(x)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ie(function(s){s=s>>>0,I(s,"offset");const o=this[s],h=this[s+7];(o===void 0||h===void 0)&&M(s,this.length-8);const y=o*2**24+this[++s]*2**16+this[++s]*2**8+this[++s],x=this[++s]*2**24+this[++s]*2**16+this[++s]*2**8+h;return(BigInt(y)<<BigInt(32))+BigInt(x)}),u.prototype.readIntLE=function(s,o,h){s=s>>>0,o=o>>>0,h||Z(s,o,this.length);let y=this[s],x=1,E=0;for(;++E<o&&(x*=256);)y+=this[s+E]*x;return x*=128,y>=x&&(y-=Math.pow(2,8*o)),y},u.prototype.readIntBE=function(s,o,h){s=s>>>0,o=o>>>0,h||Z(s,o,this.length);let y=o,x=1,E=this[s+--y];for(;y>0&&(x*=256);)E+=this[s+--y]*x;return x*=128,E>=x&&(E-=Math.pow(2,8*o)),E},u.prototype.readInt8=function(s,o){return s=s>>>0,o||Z(s,1,this.length),this[s]&128?(255-this[s]+1)*-1:this[s]},u.prototype.readInt16LE=function(s,o){s=s>>>0,o||Z(s,2,this.length);const h=this[s]|this[s+1]<<8;return h&32768?h|4294901760:h},u.prototype.readInt16BE=function(s,o){s=s>>>0,o||Z(s,2,this.length);const h=this[s+1]|this[s]<<8;return h&32768?h|4294901760:h},u.prototype.readInt32LE=function(s,o){return s=s>>>0,o||Z(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},u.prototype.readInt32BE=function(s,o){return s=s>>>0,o||Z(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},u.prototype.readBigInt64LE=Ie(function(s){s=s>>>0,I(s,"offset");const o=this[s],h=this[s+7];(o===void 0||h===void 0)&&M(s,this.length-8);const y=this[s+4]+this[s+5]*2**8+this[s+6]*2**16+(h<<24);return(BigInt(y)<<BigInt(32))+BigInt(o+this[++s]*2**8+this[++s]*2**16+this[++s]*2**24)}),u.prototype.readBigInt64BE=Ie(function(s){s=s>>>0,I(s,"offset");const o=this[s],h=this[s+7];(o===void 0||h===void 0)&&M(s,this.length-8);const y=(o<<24)+this[++s]*2**16+this[++s]*2**8+this[++s];return(BigInt(y)<<BigInt(32))+BigInt(this[++s]*2**24+this[++s]*2**16+this[++s]*2**8+h)}),u.prototype.readFloatLE=function(s,o){return s=s>>>0,o||Z(s,4,this.length),r.read(this,s,!0,23,4)},u.prototype.readFloatBE=function(s,o){return s=s>>>0,o||Z(s,4,this.length),r.read(this,s,!1,23,4)},u.prototype.readDoubleLE=function(s,o){return s=s>>>0,o||Z(s,8,this.length),r.read(this,s,!0,52,8)},u.prototype.readDoubleBE=function(s,o){return s=s>>>0,o||Z(s,8,this.length),r.read(this,s,!1,52,8)};function ae(c,s,o,h,y,x){if(!u.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>y||s<x)throw new RangeError('"value" argument is out of bounds');if(o+h>c.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(s,o,h,y){if(s=+s,o=o>>>0,h=h>>>0,!y){const q=Math.pow(2,8*h)-1;ae(this,s,o,h,q,0)}let x=1,E=0;for(this[o]=s&255;++E<h&&(x*=256);)this[o+E]=s/x&255;return o+h},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(s,o,h,y){if(s=+s,o=o>>>0,h=h>>>0,!y){const q=Math.pow(2,8*h)-1;ae(this,s,o,h,q,0)}let x=h-1,E=1;for(this[o+x]=s&255;--x>=0&&(E*=256);)this[o+x]=s/E&255;return o+h},u.prototype.writeUint8=u.prototype.writeUInt8=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,1,255,0),this[o]=s&255,o+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,2,65535,0),this[o]=s&255,this[o+1]=s>>>8,o+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,2,65535,0),this[o]=s>>>8,this[o+1]=s&255,o+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,4,4294967295,0),this[o+3]=s>>>24,this[o+2]=s>>>16,this[o+1]=s>>>8,this[o]=s&255,o+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,4,4294967295,0),this[o]=s>>>24,this[o+1]=s>>>16,this[o+2]=s>>>8,this[o+3]=s&255,o+4};function Se(c,s,o,h,y){p(s,h,y,c,o,7);let x=Number(s&BigInt(4294967295));c[o++]=x,x=x>>8,c[o++]=x,x=x>>8,c[o++]=x,x=x>>8,c[o++]=x;let E=Number(s>>BigInt(32)&BigInt(4294967295));return c[o++]=E,E=E>>8,c[o++]=E,E=E>>8,c[o++]=E,E=E>>8,c[o++]=E,o}function Ve(c,s,o,h,y){p(s,h,y,c,o,7);let x=Number(s&BigInt(4294967295));c[o+7]=x,x=x>>8,c[o+6]=x,x=x>>8,c[o+5]=x,x=x>>8,c[o+4]=x;let E=Number(s>>BigInt(32)&BigInt(4294967295));return c[o+3]=E,E=E>>8,c[o+2]=E,E=E>>8,c[o+1]=E,E=E>>8,c[o]=E,o+8}u.prototype.writeBigUInt64LE=Ie(function(s,o=0){return Se(this,s,o,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ie(function(s,o=0){return Ve(this,s,o,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(s,o,h,y){if(s=+s,o=o>>>0,!y){const ie=Math.pow(2,8*h-1);ae(this,s,o,h,ie-1,-ie)}let x=0,E=1,q=0;for(this[o]=s&255;++x<h&&(E*=256);)s<0&&q===0&&this[o+x-1]!==0&&(q=1),this[o+x]=(s/E>>0)-q&255;return o+h},u.prototype.writeIntBE=function(s,o,h,y){if(s=+s,o=o>>>0,!y){const ie=Math.pow(2,8*h-1);ae(this,s,o,h,ie-1,-ie)}let x=h-1,E=1,q=0;for(this[o+x]=s&255;--x>=0&&(E*=256);)s<0&&q===0&&this[o+x+1]!==0&&(q=1),this[o+x]=(s/E>>0)-q&255;return o+h},u.prototype.writeInt8=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,1,127,-128),s<0&&(s=255+s+1),this[o]=s&255,o+1},u.prototype.writeInt16LE=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,2,32767,-32768),this[o]=s&255,this[o+1]=s>>>8,o+2},u.prototype.writeInt16BE=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,2,32767,-32768),this[o]=s>>>8,this[o+1]=s&255,o+2},u.prototype.writeInt32LE=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,4,2147483647,-2147483648),this[o]=s&255,this[o+1]=s>>>8,this[o+2]=s>>>16,this[o+3]=s>>>24,o+4},u.prototype.writeInt32BE=function(s,o,h){return s=+s,o=o>>>0,h||ae(this,s,o,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[o]=s>>>24,this[o+1]=s>>>16,this[o+2]=s>>>8,this[o+3]=s&255,o+4},u.prototype.writeBigInt64LE=Ie(function(s,o=0){return Se(this,s,o,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ie(function(s,o=0){return Ve(this,s,o,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Me(c,s,o,h,y,x){if(o+h>c.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}function w(c,s,o,h,y){return s=+s,o=o>>>0,y||Me(c,s,o,4),r.write(c,s,o,h,23,4),o+4}u.prototype.writeFloatLE=function(s,o,h){return w(this,s,o,!0,h)},u.prototype.writeFloatBE=function(s,o,h){return w(this,s,o,!1,h)};function _(c,s,o,h,y){return s=+s,o=o>>>0,y||Me(c,s,o,8),r.write(c,s,o,h,52,8),o+8}u.prototype.writeDoubleLE=function(s,o,h){return _(this,s,o,!0,h)},u.prototype.writeDoubleBE=function(s,o,h){return _(this,s,o,!1,h)},u.prototype.copy=function(s,o,h,y){if(!u.isBuffer(s))throw new TypeError("argument should be a Buffer");if(h||(h=0),!y&&y!==0&&(y=this.length),o>=s.length&&(o=s.length),o||(o=0),y>0&&y<h&&(y=h),y===h||s.length===0||this.length===0)return 0;if(o<0)throw new RangeError("targetStart out of bounds");if(h<0||h>=this.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("sourceEnd out of bounds");y>this.length&&(y=this.length),s.length-o<y-h&&(y=s.length-o+h);const x=y-h;return this===s&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(o,h,y):Uint8Array.prototype.set.call(s,this.subarray(h,y),o),x},u.prototype.fill=function(s,o,h,y){if(typeof s=="string"){if(typeof o=="string"?(y=o,o=0,h=this.length):typeof h=="string"&&(y=h,h=this.length),y!==void 0&&typeof y!="string")throw new TypeError("encoding must be a string");if(typeof y=="string"&&!u.isEncoding(y))throw new TypeError("Unknown encoding: "+y);if(s.length===1){const E=s.charCodeAt(0);(y==="utf8"&&E<128||y==="latin1")&&(s=E)}}else typeof s=="number"?s=s&255:typeof s=="boolean"&&(s=Number(s));if(o<0||this.length<o||this.length<h)throw new RangeError("Out of range index");if(h<=o)return this;o=o>>>0,h=h===void 0?this.length:h>>>0,s||(s=0);let x;if(typeof s=="number")for(x=o;x<h;++x)this[x]=s;else{const E=u.isBuffer(s)?s:u.from(s,y),q=E.length;if(q===0)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(x=0;x<h-o;++x)this[x+o]=E[x%q]}return this};const R={};function D(c,s,o){R[c]=class extends o{constructor(){super(),Object.defineProperty(this,"message",{value:s.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${c}]`,this.stack,delete this.name}get code(){return c}set code(y){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:y,writable:!0})}toString(){return`${this.name} [${c}]: ${this.message}`}}}D("ERR_BUFFER_OUT_OF_BOUNDS",function(c){return c?`${c} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),D("ERR_INVALID_ARG_TYPE",function(c,s){return`The "${c}" argument must be of type number. Received type ${typeof s}`},TypeError),D("ERR_OUT_OF_RANGE",function(c,s,o){let h=`The value of "${c}" is out of range.`,y=o;return Number.isInteger(o)&&Math.abs(o)>2**32?y=j(String(o)):typeof o=="bigint"&&(y=String(o),(o>BigInt(2)**BigInt(32)||o<-(BigInt(2)**BigInt(32)))&&(y=j(y)),y+="n"),h+=` It must be ${s}. Received ${y}`,h},RangeError);function j(c){let s="",o=c.length;const h=c[0]==="-"?1:0;for(;o>=h+4;o-=3)s=`_${c.slice(o-3,o)}${s}`;return`${c.slice(0,o)}${s}`}function d(c,s,o){I(s,"offset"),(c[s]===void 0||c[s+o]===void 0)&&M(s,c.length-(o+1))}function p(c,s,o,h,y,x){if(c>o||c<s){const E=typeof s=="bigint"?"n":"";let q;throw s===0||s===BigInt(0)?q=`>= 0${E} and < 2${E} ** ${(x+1)*8}${E}`:q=`>= -(2${E} ** ${(x+1)*8-1}${E}) and < 2 ** ${(x+1)*8-1}${E}`,new R.ERR_OUT_OF_RANGE("value",q,c)}d(h,y,x)}function I(c,s){if(typeof c!="number")throw new R.ERR_INVALID_ARG_TYPE(s,"number",c)}function M(c,s,o){throw Math.floor(c)!==c?(I(c,o),new R.ERR_OUT_OF_RANGE("offset","an integer",c)):s<0?new R.ERR_BUFFER_OUT_OF_BOUNDS:new R.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${s}`,c)}const ee=/[^+/0-9A-Za-z-_]/g;function G(c){if(c=c.split("=")[0],c=c.trim().replace(ee,""),c.length<2)return"";for(;c.length%4!==0;)c=c+"=";return c}function V(c,s){s=s||1/0;let o;const h=c.length;let y=null;const x=[];for(let E=0;E<h;++E){if(o=c.charCodeAt(E),o>55295&&o<57344){if(!y){if(o>56319){(s-=3)>-1&&x.push(239,191,189);continue}else if(E+1===h){(s-=3)>-1&&x.push(239,191,189);continue}y=o;continue}if(o<56320){(s-=3)>-1&&x.push(239,191,189),y=o;continue}o=(y-55296<<10|o-56320)+65536}else y&&(s-=3)>-1&&x.push(239,191,189);if(y=null,o<128){if((s-=1)<0)break;x.push(o)}else if(o<2048){if((s-=2)<0)break;x.push(o>>6|192,o&63|128)}else if(o<65536){if((s-=3)<0)break;x.push(o>>12|224,o>>6&63|128,o&63|128)}else if(o<1114112){if((s-=4)<0)break;x.push(o>>18|240,o>>12&63|128,o>>6&63|128,o&63|128)}else throw new Error("Invalid code point")}return x}function Ke(c){const s=[];for(let o=0;o<c.length;++o)s.push(c.charCodeAt(o)&255);return s}function dt(c,s){let o,h,y;const x=[];for(let E=0;E<c.length&&!((s-=2)<0);++E)o=c.charCodeAt(E),h=o>>8,y=o%256,x.push(y),x.push(h);return x}function Tt(c){return t.toByteArray(G(c))}function pt(c,s,o,h){let y;for(y=0;y<h&&!(y+o>=s.length||y>=c.length);++y)s[y+o]=c[y];return y}function Ae(c,s){return c instanceof s||c!=null&&c.constructor!=null&&c.constructor.name!=null&&c.constructor.name===s.name}function rt(c){return c!==c}const Pt=function(){const c="0123456789abcdef",s=new Array(256);for(let o=0;o<16;++o){const h=o*16;for(let y=0;y<16;++y)s[h+y]=c[o]+c[y]}return s}();function Ie(c){return typeof BigInt>"u"?nt:c}function nt(){throw new Error("BigInt not supported")}})(It);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(e,t){var r=It,n=r.Buffer;function i(f,u){for(var l in f)u[l]=f[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=a);function a(f,u,l){return n(f,u,l)}a.prototype=Object.create(n.prototype),i(n,a),a.from=function(f,u,l){if(typeof f=="number")throw new TypeError("Argument must not be a number");return n(f,u,l)},a.alloc=function(f,u,l){if(typeof f!="number")throw new TypeError("Argument must be a number");var b=n(f);return u!==void 0?typeof l=="string"?b.fill(u,l):b.fill(u):b.fill(0),b},a.allocUnsafe=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return n(f)},a.allocUnsafeSlow=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(f)}})(en,en.exports);var Be=en.exports,Mr=65536,hf=4294967295;function df(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var pf=Be.Buffer,hr=Qe.crypto||Qe.msCrypto;hr&&hr.getRandomValues?Zr.exports=bf:Zr.exports=df;function bf(e,t){if(e>hf)throw new RangeError("requested too many random bytes");var r=pf.allocUnsafe(e);if(e>0)if(e>Mr)for(var n=0;n<e;n+=Mr)hr.getRandomValues(r.slice(n,n+Mr));else hr.getRandomValues(r);return typeof t=="function"?process.nextTick(function(){t(null,r)}):r}var yf=Zr.exports,tn={exports:{}};typeof Object.create=="function"?tn.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:tn.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}};var ge=tn.exports,rn={exports:{}},En={exports:{}},wt=typeof Reflect=="object"?Reflect:null,Gn=wt&&typeof wt.apply=="function"?wt.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},ir;wt&&typeof wt.ownKeys=="function"?ir=wt.ownKeys:Object.getOwnPropertySymbols?ir=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:ir=function(t){return Object.getOwnPropertyNames(t)};function gf(e){console&&console.warn&&console.warn(e)}var ts=Number.isNaN||function(t){return t!==t};function K(){K.init.call(this)}En.exports=K;En.exports.once=xf;K.EventEmitter=K;K.prototype._events=void 0;K.prototype._eventsCount=0;K.prototype._maxListeners=void 0;var Wn=10;function wr(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(K,"defaultMaxListeners",{enumerable:!0,get:function(){return Wn},set:function(e){if(typeof e!="number"||e<0||ts(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Wn=e}});K.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};K.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||ts(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function rs(e){return e._maxListeners===void 0?K.defaultMaxListeners:e._maxListeners}K.prototype.getMaxListeners=function(){return rs(this)};K.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var f;if(r.length>0&&(f=r[0]),f instanceof Error)throw f;var u=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw u.context=f,u}var l=a[t];if(l===void 0)return!1;if(typeof l=="function")Gn(l,this,r);else for(var b=l.length,g=as(l,b),n=0;n<b;++n)Gn(g[n],this,r);return!0};function ns(e,t,r,n){var i,a,f;if(wr(r),a=e._events,a===void 0?(a=e._events=Object.create(null),e._eventsCount=0):(a.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),f=a[t]),f===void 0)f=a[t]=r,++e._eventsCount;else if(typeof f=="function"?f=a[t]=n?[r,f]:[f,r]:n?f.unshift(r):f.push(r),i=rs(e),i>0&&f.length>i&&!f.warned){f.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=f.length,gf(u)}return e}K.prototype.addListener=function(t,r){return ns(this,t,r,!1)};K.prototype.on=K.prototype.addListener;K.prototype.prependListener=function(t,r){return ns(this,t,r,!0)};function mf(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function is(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=mf.bind(n);return i.listener=r,n.wrapFn=i,i}K.prototype.once=function(t,r){return wr(r),this.on(t,is(this,t,r)),this};K.prototype.prependOnceListener=function(t,r){return wr(r),this.prependListener(t,is(this,t,r)),this};K.prototype.removeListener=function(t,r){var n,i,a,f,u;if(wr(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,f=n.length-1;f>=0;f--)if(n[f]===r||n[f].listener===r){u=n[f].listener,a=f;break}if(a<0)return this;a===0?n.shift():_f(n,a),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,u||r)}return this};K.prototype.off=K.prototype.removeListener;K.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var a=Object.keys(n),f;for(i=0;i<a.length;++i)f=a[i],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function ss(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?wf(i):as(i,i.length)}K.prototype.listeners=function(t){return ss(this,t,!0)};K.prototype.rawListeners=function(t){return ss(this,t,!1)};K.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):os.call(e,t)};K.prototype.listenerCount=os;function os(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}K.prototype.eventNames=function(){return this._eventsCount>0?ir(this._events):[]};function as(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function _f(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function wf(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function xf(e,t){return new Promise(function(r,n){function i(f){e.removeListener(t,a),n(f)}function a(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}fs(e,t,a,{once:!0}),t!=="error"&&vf(e,i,{once:!0})})}function vf(e,t,r){typeof e.on=="function"&&fs(e,"error",t,r)}function fs(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(a){n.once&&e.removeEventListener(t,i),r(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var us=En.exports,cs=us.EventEmitter;const Ef={},Bf=Object.freeze(Object.defineProperty({__proto__:null,default:Ef},Symbol.toStringTag,{value:"Module"})),Bn=Ya(Bf);var Nr,qn;function Sf(){if(qn)return Nr;qn=1;function e(B,k){var T=Object.keys(B);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(B);k&&(C=C.filter(function(F){return Object.getOwnPropertyDescriptor(B,F).enumerable})),T.push.apply(T,C)}return T}function t(B){for(var k=1;k<arguments.length;k++){var T=arguments[k]!=null?arguments[k]:{};k%2?e(Object(T),!0).forEach(function(C){r(B,C,T[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(T)):e(Object(T)).forEach(function(C){Object.defineProperty(B,C,Object.getOwnPropertyDescriptor(T,C))})}return B}function r(B,k,T){return k=f(k),k in B?Object.defineProperty(B,k,{value:T,enumerable:!0,configurable:!0,writable:!0}):B[k]=T,B}function n(B,k){if(!(B instanceof k))throw new TypeError("Cannot call a class as a function")}function i(B,k){for(var T=0;T<k.length;T++){var C=k[T];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(B,f(C.key),C)}}function a(B,k,T){return k&&i(B.prototype,k),Object.defineProperty(B,"prototype",{writable:!1}),B}function f(B){var k=u(B,"string");return typeof k=="symbol"?k:String(k)}function u(B,k){if(typeof B!="object"||B===null)return B;var T=B[Symbol.toPrimitive];if(T!==void 0){var C=T.call(B,k||"default");if(typeof C!="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(B)}var l=It,b=l.Buffer,g=Bn,m=g.inspect,v=m&&m.custom||"inspect";function A(B,k,T){b.prototype.copy.call(B,k,T)}return Nr=function(){function B(){n(this,B),this.head=null,this.tail=null,this.length=0}return a(B,[{key:"push",value:function(T){var C={data:T,next:null};this.length>0?this.tail.next=C:this.head=C,this.tail=C,++this.length}},{key:"unshift",value:function(T){var C={data:T,next:this.head};this.length===0&&(this.tail=C),this.head=C,++this.length}},{key:"shift",value:function(){if(this.length!==0){var T=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,T}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(T){if(this.length===0)return"";for(var C=this.head,F=""+C.data;C=C.next;)F+=T+C.data;return F}},{key:"concat",value:function(T){if(this.length===0)return b.alloc(0);for(var C=b.allocUnsafe(T>>>0),F=this.head,O=0;F;)A(F.data,C,O),O+=F.data.length,F=F.next;return C}},{key:"consume",value:function(T,C){var F;return T<this.head.data.length?(F=this.head.data.slice(0,T),this.head.data=this.head.data.slice(T)):T===this.head.data.length?F=this.shift():F=C?this._getString(T):this._getBuffer(T),F}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(T){var C=this.head,F=1,O=C.data;for(T-=O.length;C=C.next;){var L=C.data,U=T>L.length?L.length:T;if(U===L.length?O+=L:O+=L.slice(0,T),T-=U,T===0){U===L.length?(++F,C.next?this.head=C.next:this.head=this.tail=null):(this.head=C,C.data=L.slice(U));break}++F}return this.length-=F,O}},{key:"_getBuffer",value:function(T){var C=b.allocUnsafe(T),F=this.head,O=1;for(F.data.copy(C),T-=F.data.length;F=F.next;){var L=F.data,U=T>L.length?L.length:T;if(L.copy(C,C.length-T,0,U),T-=U,T===0){U===L.length?(++O,F.next?this.head=F.next:this.head=this.tail=null):(this.head=F,F.data=L.slice(U));break}++O}return this.length-=O,C}},{key:v,value:function(T,C){return m(this,t(t({},C),{},{depth:0,customInspect:!1}))}}]),B}(),Nr}function Af(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(nn,this,e)):process.nextTick(nn,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(a){!t&&a?r._writableState?r._writableState.errorEmitted?process.nextTick(sr,r):(r._writableState.errorEmitted=!0,process.nextTick(Vn,r,a)):process.nextTick(Vn,r,a):t?(process.nextTick(sr,r),t(a)):process.nextTick(sr,r)}),this)}function Vn(e,t){nn(e,t),sr(e)}function sr(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function If(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function nn(e,t){e.emit("error",t)}function Rf(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}var ls={destroy:Af,undestroy:If,errorOrDestroy:Rf},lt={};function Tf(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var hs={};function Te(e,t,r){r||(r=Error);function n(a,f,u){return typeof t=="string"?t:t(a,f,u)}var i=function(a){Tf(f,a);function f(u,l,b){return a.call(this,n(u,l,b))||this}return f}(r);i.prototype.name=r.name,i.prototype.code=e,hs[e]=i}function Kn(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map(function(n){return String(n)}),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:r===2?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}else return"of ".concat(t," ").concat(String(e))}function Pf(e,t,r){return e.substr(0,t.length)===t}function kf(e,t,r){return(r===void 0||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function Cf(e,t,r){return typeof r!="number"&&(r=0),r+t.length>e.length?!1:e.indexOf(t,r)!==-1}Te("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError);Te("ERR_INVALID_ARG_TYPE",function(e,t,r){var n;typeof t=="string"&&Pf(t,"not ")?(n="must not be",t=t.replace(/^not /,"")):n="must be";var i;if(kf(e," argument"))i="The ".concat(e," ").concat(n," ").concat(Kn(t,"type"));else{var a=Cf(e,".")?"property":"argument";i='The "'.concat(e,'" ').concat(a," ").concat(n," ").concat(Kn(t,"type"))}return i+=". Received type ".concat(typeof r),i},TypeError);Te("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Te("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"});Te("ERR_STREAM_PREMATURE_CLOSE","Premature close");Te("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"});Te("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Te("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Te("ERR_STREAM_WRITE_AFTER_END","write after end");Te("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Te("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError);Te("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");lt.codes=hs;var Lf=lt.codes.ERR_INVALID_OPT_VALUE;function Of(e,t,r){return e.highWaterMark!=null?e.highWaterMark:t?e[r]:null}function Ff(e,t,r,n){var i=Of(t,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var a=n?r:"highWaterMark";throw new Lf(a,i)}return Math.floor(i)}return e.objectMode?16:16*1024}var ds={getHighWaterMark:Ff},Uf=Mf;function Mf(e,t){if(Dr("noDeprecation"))return e;var r=!1;function n(){if(!r){if(Dr("throwDeprecation"))throw new Error(t);Dr("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}return n}function Dr(e){try{if(!Qe.localStorage)return!1}catch{return!1}var t=Qe.localStorage[e];return t==null?!1:String(t).toLowerCase()==="true"}var $r,Yn;function ps(){if(Yn)return $r;Yn=1,$r=N;function e(w){var _=this;this.next=null,this.entry=null,this.finish=function(){Me(_,w)}}var t;N.WritableState=S;var r={deprecate:Uf},n=cs,i=It.Buffer,a=(typeof Qe<"u"?Qe:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function f(w){return i.from(w)}function u(w){return i.isBuffer(w)||w instanceof a}var l=ls,b=ds,g=b.getHighWaterMark,m=lt.codes,v=m.ERR_INVALID_ARG_TYPE,A=m.ERR_METHOD_NOT_IMPLEMENTED,B=m.ERR_MULTIPLE_CALLBACK,k=m.ERR_STREAM_CANNOT_PIPE,T=m.ERR_STREAM_DESTROYED,C=m.ERR_STREAM_NULL_VALUES,F=m.ERR_STREAM_WRITE_AFTER_END,O=m.ERR_UNKNOWN_ENCODING,L=l.errorOrDestroy;ge(N,n);function U(){}function S(w,_,R){t=t||Bt(),w=w||{},typeof R!="boolean"&&(R=_ instanceof t),this.objectMode=!!w.objectMode,R&&(this.objectMode=this.objectMode||!!w.writableObjectMode),this.highWaterMark=g(this,w,"writableHighWaterMark",R),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var D=w.decodeStrings===!1;this.decodeStrings=!D,this.defaultEncoding=w.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(j){tt(_,j)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=w.emitClose!==!1,this.autoDestroy=!!w.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}S.prototype.getBuffer=function(){for(var _=this.bufferedRequest,R=[];_;)R.push(_),_=_.next;return R},function(){try{Object.defineProperty(S.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var z;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(z=Function.prototype[Symbol.hasInstance],Object.defineProperty(N,Symbol.hasInstance,{value:function(_){return z.call(this,_)?!0:this!==N?!1:_&&_._writableState instanceof S}})):z=function(_){return _ instanceof this};function N(w){t=t||Bt();var _=this instanceof t;if(!_&&!z.call(N,this))return new N(w);this._writableState=new S(w,this,_),this.writable=!0,w&&(typeof w.write=="function"&&(this._write=w.write),typeof w.writev=="function"&&(this._writev=w.writev),typeof w.destroy=="function"&&(this._destroy=w.destroy),typeof w.final=="function"&&(this._final=w.final)),n.call(this)}N.prototype.pipe=function(){L(this,new k)};function $(w,_){var R=new F;L(w,R),process.nextTick(_,R)}function oe(w,_,R,D){var j;return R===null?j=new C:typeof R!="string"&&!_.objectMode&&(j=new v("chunk",["string","Buffer"],R)),j?(L(w,j),process.nextTick(D,j),!1):!0}N.prototype.write=function(w,_,R){var D=this._writableState,j=!1,d=!D.objectMode&&u(w);return d&&!i.isBuffer(w)&&(w=f(w)),typeof _=="function"&&(R=_,_=null),d?_="buffer":_||(_=D.defaultEncoding),typeof R!="function"&&(R=U),D.ending?$(this,R):(d||oe(this,D,w,R))&&(D.pendingcb++,j=Ge(this,D,d,w,_,R)),j},N.prototype.cork=function(){this._writableState.corked++},N.prototype.uncork=function(){var w=this._writableState;w.corked&&(w.corked--,!w.writing&&!w.corked&&!w.bufferProcessing&&w.bufferedRequest&&Ce(this,w))},N.prototype.setDefaultEncoding=function(_){if(typeof _=="string"&&(_=_.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((_+"").toLowerCase())>-1))throw new O(_);return this._writableState.defaultEncoding=_,this},Object.defineProperty(N.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Pe(w,_,R){return!w.objectMode&&w.decodeStrings!==!1&&typeof _=="string"&&(_=i.from(_,R)),_}Object.defineProperty(N.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Ge(w,_,R,D,j,d){if(!R){var p=Pe(_,D,j);D!==p&&(R=!0,j="buffer",D=p)}var I=_.objectMode?1:D.length;_.length+=I;var M=_.length<_.highWaterMark;if(M||(_.needDrain=!0),_.writing||_.corked){var ee=_.lastBufferedRequest;_.lastBufferedRequest={chunk:D,encoding:j,isBuf:R,callback:d,next:null},ee?ee.next=_.lastBufferedRequest:_.bufferedRequest=_.lastBufferedRequest,_.bufferedRequestCount+=1}else fe(w,_,!1,I,D,j,d);return M}function fe(w,_,R,D,j,d,p){_.writelen=D,_.writecb=p,_.writing=!0,_.sync=!0,_.destroyed?_.onwrite(new T("write")):R?w._writev(j,_.onwrite):w._write(j,d,_.onwrite),_.sync=!1}function ve(w,_,R,D,j){--_.pendingcb,R?(process.nextTick(j,D),process.nextTick(Se,w,_),w._writableState.errorEmitted=!0,L(w,D)):(j(D),w._writableState.errorEmitted=!0,L(w,D),Se(w,_))}function Ee(w){w.writing=!1,w.writecb=null,w.length-=w.writelen,w.writelen=0}function tt(w,_){var R=w._writableState,D=R.sync,j=R.writecb;if(typeof j!="function")throw new B;if(Ee(R),_)ve(w,R,D,_,j);else{var d=qe(R)||w.destroyed;!d&&!R.corked&&!R.bufferProcessing&&R.bufferedRequest&&Ce(w,R),D?process.nextTick(ke,w,R,d,j):ke(w,R,d,j)}}function ke(w,_,R,D){R||We(w,_),_.pendingcb--,D(),Se(w,_)}function We(w,_){_.length===0&&_.needDrain&&(_.needDrain=!1,w.emit("drain"))}function Ce(w,_){_.bufferProcessing=!0;var R=_.bufferedRequest;if(w._writev&&R&&R.next){var D=_.bufferedRequestCount,j=new Array(D),d=_.corkedRequestsFree;d.entry=R;for(var p=0,I=!0;R;)j[p]=R,R.isBuf||(I=!1),R=R.next,p+=1;j.allBuffers=I,fe(w,_,!0,_.length,j,"",d.finish),_.pendingcb++,_.lastBufferedRequest=null,d.next?(_.corkedRequestsFree=d.next,d.next=null):_.corkedRequestsFree=new e(_),_.bufferedRequestCount=0}else{for(;R;){var M=R.chunk,ee=R.encoding,G=R.callback,V=_.objectMode?1:M.length;if(fe(w,_,!1,V,M,ee,G),R=R.next,_.bufferedRequestCount--,_.writing)break}R===null&&(_.lastBufferedRequest=null)}_.bufferedRequest=R,_.bufferProcessing=!1}N.prototype._write=function(w,_,R){R(new A("_write()"))},N.prototype._writev=null,N.prototype.end=function(w,_,R){var D=this._writableState;return typeof w=="function"?(R=w,w=null,_=null):typeof _=="function"&&(R=_,_=null),w!=null&&this.write(w,_),D.corked&&(D.corked=1,this.uncork()),D.ending||Ve(this,D,R),this},Object.defineProperty(N.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function qe(w){return w.ending&&w.length===0&&w.bufferedRequest===null&&!w.finished&&!w.writing}function Z(w,_){w._final(function(R){_.pendingcb--,R&&L(w,R),_.prefinished=!0,w.emit("prefinish"),Se(w,_)})}function ae(w,_){!_.prefinished&&!_.finalCalled&&(typeof w._final=="function"&&!_.destroyed?(_.pendingcb++,_.finalCalled=!0,process.nextTick(Z,w,_)):(_.prefinished=!0,w.emit("prefinish")))}function Se(w,_){var R=qe(_);if(R&&(ae(w,_),_.pendingcb===0&&(_.finished=!0,w.emit("finish"),_.autoDestroy))){var D=w._readableState;(!D||D.autoDestroy&&D.endEmitted)&&w.destroy()}return R}function Ve(w,_,R){_.ending=!0,Se(w,_),R&&(_.finished?process.nextTick(R):w.once("finish",R)),_.ended=!0,w.writable=!1}function Me(w,_,R){var D=w.entry;for(w.entry=null;D;){var j=D.callback;_.pendingcb--,j(R),D=D.next}_.corkedRequestsFree.next=w}return Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(_){this._writableState&&(this._writableState.destroyed=_)}}),N.prototype.destroy=l.destroy,N.prototype._undestroy=l.undestroy,N.prototype._destroy=function(w,_){_(w)},$r}var Hr,Jn;function Bt(){if(Jn)return Hr;Jn=1;var e=Object.keys||function(b){var g=[];for(var m in b)g.push(m);return g};Hr=f;var t=ys(),r=ps();ge(f,t);for(var n=e(r.prototype),i=0;i<n.length;i++){var a=n[i];f.prototype[a]||(f.prototype[a]=r.prototype[a])}function f(b){if(!(this instanceof f))return new f(b);t.call(this,b),r.call(this,b),this.allowHalfOpen=!0,b&&(b.readable===!1&&(this.readable=!1),b.writable===!1&&(this.writable=!1),b.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u)))}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function u(){this._writableState.ended||process.nextTick(l,this)}function l(b){b.end()}return Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=g,this._writableState.destroyed=g)}}),Hr}var dr={},Sn=Be.Buffer,Xn=Sn.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Nf(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function Df(e){var t=Nf(e);if(typeof t!="string"&&(Sn.isEncoding===Xn||!Xn(e)))throw new Error("Unknown encoding: "+e);return t||e}dr.StringDecoder=Jt;function Jt(e){this.encoding=Df(e);var t;switch(this.encoding){case"utf16le":this.text=Wf,this.end=qf,t=4;break;case"utf8":this.fillLast=zf,t=4;break;case"base64":this.text=Vf,this.end=Kf,t=3;break;default:this.write=Yf,this.end=Jf;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Sn.allocUnsafe(t)}Jt.prototype.write=function(e){if(e.length===0)return"";var t,r;if(this.lastNeed){if(t=this.fillLast(e),t===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""};Jt.prototype.end=Gf;Jt.prototype.text=jf;Jt.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};function zr(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function $f(e,t,r){var n=t.length-1;if(n<r)return 0;var i=zr(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||i===-2?0:(i=zr(t[n]),i>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||i===-2?0:(i=zr(t[n]),i>=0?(i>0&&(i===2?i=0:e.lastNeed=i-3),i):0))}function Hf(e,t,r){if((t[0]&192)!==128)return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128)return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&(t[2]&192)!==128)return e.lastNeed=2,"�"}}function zf(e){var t=this.lastTotal-this.lastNeed,r=Hf(this,e);if(r!==void 0)return r;if(this.lastNeed<=e.length)return e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length}function jf(e,t){var r=$f(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)}function Gf(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t}function Wf(e,t){if((e.length-t)%2===0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function qf(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function Vf(e,t){var r=(e.length-t)%3;return r===0?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function Kf(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function Yf(e){return e.toString(this.encoding)}function Jf(e){return e&&e.length?this.write(e):""}var Qn=lt.codes.ERR_STREAM_PREMATURE_CLOSE;function Xf(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}function Qf(){}function Zf(e){return e.setHeader&&typeof e.abort=="function"}function bs(e,t,r){if(typeof t=="function")return bs(e,null,t);t||(t={}),r=Xf(r||Qf);var n=t.readable||t.readable!==!1&&e.readable,i=t.writable||t.writable!==!1&&e.writable,a=function(){e.writable||u()},f=e._writableState&&e._writableState.finished,u=function(){i=!1,f=!0,n||r.call(e)},l=e._readableState&&e._readableState.endEmitted,b=function(){n=!1,l=!0,i||r.call(e)},g=function(B){r.call(e,B)},m=function(){var B;if(n&&!l)return(!e._readableState||!e._readableState.ended)&&(B=new Qn),r.call(e,B);if(i&&!f)return(!e._writableState||!e._writableState.ended)&&(B=new Qn),r.call(e,B)},v=function(){e.req.on("finish",u)};return Zf(e)?(e.on("complete",u),e.on("abort",m),e.req?v():e.on("request",v)):i&&!e._writableState&&(e.on("end",a),e.on("close",a)),e.on("end",b),e.on("finish",u),t.error!==!1&&e.on("error",g),e.on("close",m),function(){e.removeListener("complete",u),e.removeListener("abort",m),e.removeListener("request",v),e.req&&e.req.removeListener("finish",u),e.removeListener("end",a),e.removeListener("close",a),e.removeListener("finish",u),e.removeListener("end",b),e.removeListener("error",g),e.removeListener("close",m)}}var An=bs,jr,Zn;function eu(){if(Zn)return jr;Zn=1;var e;function t(O,L,U){return L=r(L),L in O?Object.defineProperty(O,L,{value:U,enumerable:!0,configurable:!0,writable:!0}):O[L]=U,O}function r(O){var L=n(O,"string");return typeof L=="symbol"?L:String(L)}function n(O,L){if(typeof O!="object"||O===null)return O;var U=O[Symbol.toPrimitive];if(U!==void 0){var S=U.call(O,L||"default");if(typeof S!="object")return S;throw new TypeError("@@toPrimitive must return a primitive value.")}return(L==="string"?String:Number)(O)}var i=An,a=Symbol("lastResolve"),f=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),b=Symbol("lastPromise"),g=Symbol("handlePromise"),m=Symbol("stream");function v(O,L){return{value:O,done:L}}function A(O){var L=O[a];if(L!==null){var U=O[m].read();U!==null&&(O[b]=null,O[a]=null,O[f]=null,L(v(U,!1)))}}function B(O){process.nextTick(A,O)}function k(O,L){return function(U,S){O.then(function(){if(L[l]){U(v(void 0,!0));return}L[g](U,S)},S)}}var T=Object.getPrototypeOf(function(){}),C=Object.setPrototypeOf((e={get stream(){return this[m]},next:function(){var L=this,U=this[u];if(U!==null)return Promise.reject(U);if(this[l])return Promise.resolve(v(void 0,!0));if(this[m].destroyed)return new Promise(function($,oe){process.nextTick(function(){L[u]?oe(L[u]):$(v(void 0,!0))})});var S=this[b],z;if(S)z=new Promise(k(S,this));else{var N=this[m].read();if(N!==null)return Promise.resolve(v(N,!1));z=new Promise(this[g])}return this[b]=z,z}},t(e,Symbol.asyncIterator,function(){return this}),t(e,"return",function(){var L=this;return new Promise(function(U,S){L[m].destroy(null,function(z){if(z){S(z);return}U(v(void 0,!0))})})}),e),T),F=function(L){var U,S=Object.create(C,(U={},t(U,m,{value:L,writable:!0}),t(U,a,{value:null,writable:!0}),t(U,f,{value:null,writable:!0}),t(U,u,{value:null,writable:!0}),t(U,l,{value:L._readableState.endEmitted,writable:!0}),t(U,g,{value:function(N,$){var oe=S[m].read();oe?(S[b]=null,S[a]=null,S[f]=null,N(v(oe,!1))):(S[a]=N,S[f]=$)},writable:!0}),U));return S[b]=null,i(L,function(z){if(z&&z.code!=="ERR_STREAM_PREMATURE_CLOSE"){var N=S[f];N!==null&&(S[b]=null,S[a]=null,S[f]=null,N(z)),S[u]=z;return}var $=S[a];$!==null&&(S[b]=null,S[a]=null,S[f]=null,$(v(void 0,!0))),S[l]=!0}),L.on("readable",B.bind(null,S)),S};return jr=F,jr}var Gr,ei;function tu(){return ei||(ei=1,Gr=function(){throw new Error("Readable.from is not available in the browser")}),Gr}var Wr,ti;function ys(){if(ti)return Wr;ti=1,Wr=$;var e;$.ReadableState=N,us.EventEmitter;var t=function(p,I){return p.listeners(I).length},r=cs,n=It.Buffer,i=(typeof Qe<"u"?Qe:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function a(d){return n.from(d)}function f(d){return n.isBuffer(d)||d instanceof i}var u=Bn,l;u&&u.debuglog?l=u.debuglog("stream"):l=function(){};var b=Sf(),g=ls,m=ds,v=m.getHighWaterMark,A=lt.codes,B=A.ERR_INVALID_ARG_TYPE,k=A.ERR_STREAM_PUSH_AFTER_EOF,T=A.ERR_METHOD_NOT_IMPLEMENTED,C=A.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,F,O,L;ge($,r);var U=g.errorOrDestroy,S=["error","close","destroy","pause","resume"];function z(d,p,I){if(typeof d.prependListener=="function")return d.prependListener(p,I);!d._events||!d._events[p]?d.on(p,I):Array.isArray(d._events[p])?d._events[p].unshift(I):d._events[p]=[I,d._events[p]]}function N(d,p,I){e=e||Bt(),d=d||{},typeof I!="boolean"&&(I=p instanceof e),this.objectMode=!!d.objectMode,I&&(this.objectMode=this.objectMode||!!d.readableObjectMode),this.highWaterMark=v(this,d,"readableHighWaterMark",I),this.buffer=new b,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=d.emitClose!==!1,this.autoDestroy=!!d.autoDestroy,this.destroyed=!1,this.defaultEncoding=d.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,d.encoding&&(F||(F=dr.StringDecoder),this.decoder=new F(d.encoding),this.encoding=d.encoding)}function $(d){if(e=e||Bt(),!(this instanceof $))return new $(d);var p=this instanceof e;this._readableState=new N(d,this,p),this.readable=!0,d&&(typeof d.read=="function"&&(this._read=d.read),typeof d.destroy=="function"&&(this._destroy=d.destroy)),r.call(this)}Object.defineProperty($.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(p){this._readableState&&(this._readableState.destroyed=p)}}),$.prototype.destroy=g.destroy,$.prototype._undestroy=g.undestroy,$.prototype._destroy=function(d,p){p(d)},$.prototype.push=function(d,p){var I=this._readableState,M;return I.objectMode?M=!0:typeof d=="string"&&(p=p||I.defaultEncoding,p!==I.encoding&&(d=n.from(d,p),p=""),M=!0),oe(this,d,p,!1,M)},$.prototype.unshift=function(d){return oe(this,d,null,!0,!1)};function oe(d,p,I,M,ee){l("readableAddChunk",p);var G=d._readableState;if(p===null)G.reading=!1,tt(d,G);else{var V;if(ee||(V=Ge(G,p)),V)U(d,V);else if(G.objectMode||p&&p.length>0)if(typeof p!="string"&&!G.objectMode&&Object.getPrototypeOf(p)!==n.prototype&&(p=a(p)),M)G.endEmitted?U(d,new C):Pe(d,G,p,!0);else if(G.ended)U(d,new k);else{if(G.destroyed)return!1;G.reading=!1,G.decoder&&!I?(p=G.decoder.write(p),G.objectMode||p.length!==0?Pe(d,G,p,!1):Ce(d,G)):Pe(d,G,p,!1)}else M||(G.reading=!1,Ce(d,G))}return!G.ended&&(G.length<G.highWaterMark||G.length===0)}function Pe(d,p,I,M){p.flowing&&p.length===0&&!p.sync?(p.awaitDrain=0,d.emit("data",I)):(p.length+=p.objectMode?1:I.length,M?p.buffer.unshift(I):p.buffer.push(I),p.needReadable&&ke(d)),Ce(d,p)}function Ge(d,p){var I;return!f(p)&&typeof p!="string"&&p!==void 0&&!d.objectMode&&(I=new B("chunk",["string","Buffer","Uint8Array"],p)),I}$.prototype.isPaused=function(){return this._readableState.flowing===!1},$.prototype.setEncoding=function(d){F||(F=dr.StringDecoder);var p=new F(d);this._readableState.decoder=p,this._readableState.encoding=this._readableState.decoder.encoding;for(var I=this._readableState.buffer.head,M="";I!==null;)M+=p.write(I.data),I=I.next;return this._readableState.buffer.clear(),M!==""&&this._readableState.buffer.push(M),this._readableState.length=M.length,this};var fe=1073741824;function ve(d){return d>=fe?d=fe:(d--,d|=d>>>1,d|=d>>>2,d|=d>>>4,d|=d>>>8,d|=d>>>16,d++),d}function Ee(d,p){return d<=0||p.length===0&&p.ended?0:p.objectMode?1:d!==d?p.flowing&&p.length?p.buffer.head.data.length:p.length:(d>p.highWaterMark&&(p.highWaterMark=ve(d)),d<=p.length?d:p.ended?p.length:(p.needReadable=!0,0))}$.prototype.read=function(d){l("read",d),d=parseInt(d,10);var p=this._readableState,I=d;if(d!==0&&(p.emittedReadable=!1),d===0&&p.needReadable&&((p.highWaterMark!==0?p.length>=p.highWaterMark:p.length>0)||p.ended))return l("read: emitReadable",p.length,p.ended),p.length===0&&p.ended?R(this):ke(this),null;if(d=Ee(d,p),d===0&&p.ended)return p.length===0&&R(this),null;var M=p.needReadable;l("need readable",M),(p.length===0||p.length-d<p.highWaterMark)&&(M=!0,l("length less than watermark",M)),p.ended||p.reading?(M=!1,l("reading or ended",M)):M&&(l("do read"),p.reading=!0,p.sync=!0,p.length===0&&(p.needReadable=!0),this._read(p.highWaterMark),p.sync=!1,p.reading||(d=Ee(I,p)));var ee;return d>0?ee=_(d,p):ee=null,ee===null?(p.needReadable=p.length<=p.highWaterMark,d=0):(p.length-=d,p.awaitDrain=0),p.length===0&&(p.ended||(p.needReadable=!0),I!==d&&p.ended&&R(this)),ee!==null&&this.emit("data",ee),ee};function tt(d,p){if(l("onEofChunk"),!p.ended){if(p.decoder){var I=p.decoder.end();I&&I.length&&(p.buffer.push(I),p.length+=p.objectMode?1:I.length)}p.ended=!0,p.sync?ke(d):(p.needReadable=!1,p.emittedReadable||(p.emittedReadable=!0,We(d)))}}function ke(d){var p=d._readableState;l("emitReadable",p.needReadable,p.emittedReadable),p.needReadable=!1,p.emittedReadable||(l("emitReadable",p.flowing),p.emittedReadable=!0,process.nextTick(We,d))}function We(d){var p=d._readableState;l("emitReadable_",p.destroyed,p.length,p.ended),!p.destroyed&&(p.length||p.ended)&&(d.emit("readable"),p.emittedReadable=!1),p.needReadable=!p.flowing&&!p.ended&&p.length<=p.highWaterMark,w(d)}function Ce(d,p){p.readingMore||(p.readingMore=!0,process.nextTick(qe,d,p))}function qe(d,p){for(;!p.reading&&!p.ended&&(p.length<p.highWaterMark||p.flowing&&p.length===0);){var I=p.length;if(l("maybeReadMore read 0"),d.read(0),I===p.length)break}p.readingMore=!1}$.prototype._read=function(d){U(this,new T("_read()"))},$.prototype.pipe=function(d,p){var I=this,M=this._readableState;switch(M.pipesCount){case 0:M.pipes=d;break;case 1:M.pipes=[M.pipes,d];break;default:M.pipes.push(d);break}M.pipesCount+=1,l("pipe count=%d opts=%j",M.pipesCount,p);var ee=(!p||p.end!==!1)&&d!==process.stdout&&d!==process.stderr,G=ee?Ke:nt;M.endEmitted?process.nextTick(G):I.once("end",G),d.on("unpipe",V);function V(c,s){l("onunpipe"),c===I&&s&&s.hasUnpiped===!1&&(s.hasUnpiped=!0,pt())}function Ke(){l("onend"),d.end()}var dt=Z(I);d.on("drain",dt);var Tt=!1;function pt(){l("cleanup"),d.removeListener("close",Pt),d.removeListener("finish",Ie),d.removeListener("drain",dt),d.removeListener("error",rt),d.removeListener("unpipe",V),I.removeListener("end",Ke),I.removeListener("end",nt),I.removeListener("data",Ae),Tt=!0,M.awaitDrain&&(!d._writableState||d._writableState.needDrain)&&dt()}I.on("data",Ae);function Ae(c){l("ondata");var s=d.write(c);l("dest.write",s),s===!1&&((M.pipesCount===1&&M.pipes===d||M.pipesCount>1&&j(M.pipes,d)!==-1)&&!Tt&&(l("false write response, pause",M.awaitDrain),M.awaitDrain++),I.pause())}function rt(c){l("onerror",c),nt(),d.removeListener("error",rt),t(d,"error")===0&&U(d,c)}z(d,"error",rt);function Pt(){d.removeListener("finish",Ie),nt()}d.once("close",Pt);function Ie(){l("onfinish"),d.removeListener("close",Pt),nt()}d.once("finish",Ie);function nt(){l("unpipe"),I.unpipe(d)}return d.emit("pipe",I),M.flowing||(l("pipe resume"),I.resume()),d};function Z(d){return function(){var I=d._readableState;l("pipeOnDrain",I.awaitDrain),I.awaitDrain&&I.awaitDrain--,I.awaitDrain===0&&t(d,"data")&&(I.flowing=!0,w(d))}}$.prototype.unpipe=function(d){var p=this._readableState,I={hasUnpiped:!1};if(p.pipesCount===0)return this;if(p.pipesCount===1)return d&&d!==p.pipes?this:(d||(d=p.pipes),p.pipes=null,p.pipesCount=0,p.flowing=!1,d&&d.emit("unpipe",this,I),this);if(!d){var M=p.pipes,ee=p.pipesCount;p.pipes=null,p.pipesCount=0,p.flowing=!1;for(var G=0;G<ee;G++)M[G].emit("unpipe",this,{hasUnpiped:!1});return this}var V=j(p.pipes,d);return V===-1?this:(p.pipes.splice(V,1),p.pipesCount-=1,p.pipesCount===1&&(p.pipes=p.pipes[0]),d.emit("unpipe",this,I),this)},$.prototype.on=function(d,p){var I=r.prototype.on.call(this,d,p),M=this._readableState;return d==="data"?(M.readableListening=this.listenerCount("readable")>0,M.flowing!==!1&&this.resume()):d==="readable"&&!M.endEmitted&&!M.readableListening&&(M.readableListening=M.needReadable=!0,M.flowing=!1,M.emittedReadable=!1,l("on readable",M.length,M.reading),M.length?ke(this):M.reading||process.nextTick(Se,this)),I},$.prototype.addListener=$.prototype.on,$.prototype.removeListener=function(d,p){var I=r.prototype.removeListener.call(this,d,p);return d==="readable"&&process.nextTick(ae,this),I},$.prototype.removeAllListeners=function(d){var p=r.prototype.removeAllListeners.apply(this,arguments);return(d==="readable"||d===void 0)&&process.nextTick(ae,this),p};function ae(d){var p=d._readableState;p.readableListening=d.listenerCount("readable")>0,p.resumeScheduled&&!p.paused?p.flowing=!0:d.listenerCount("data")>0&&d.resume()}function Se(d){l("readable nexttick read 0"),d.read(0)}$.prototype.resume=function(){var d=this._readableState;return d.flowing||(l("resume"),d.flowing=!d.readableListening,Ve(this,d)),d.paused=!1,this};function Ve(d,p){p.resumeScheduled||(p.resumeScheduled=!0,process.nextTick(Me,d,p))}function Me(d,p){l("resume",p.reading),p.reading||d.read(0),p.resumeScheduled=!1,d.emit("resume"),w(d),p.flowing&&!p.reading&&d.read(0)}$.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function w(d){var p=d._readableState;for(l("flow",p.flowing);p.flowing&&d.read()!==null;);}$.prototype.wrap=function(d){var p=this,I=this._readableState,M=!1;d.on("end",function(){if(l("wrapped end"),I.decoder&&!I.ended){var V=I.decoder.end();V&&V.length&&p.push(V)}p.push(null)}),d.on("data",function(V){if(l("wrapped data"),I.decoder&&(V=I.decoder.write(V)),!(I.objectMode&&V==null)&&!(!I.objectMode&&(!V||!V.length))){var Ke=p.push(V);Ke||(M=!0,d.pause())}});for(var ee in d)this[ee]===void 0&&typeof d[ee]=="function"&&(this[ee]=function(Ke){return function(){return d[Ke].apply(d,arguments)}}(ee));for(var G=0;G<S.length;G++)d.on(S[G],this.emit.bind(this,S[G]));return this._read=function(V){l("wrapped _read",V),M&&(M=!1,d.resume())},this},typeof Symbol=="function"&&($.prototype[Symbol.asyncIterator]=function(){return O===void 0&&(O=eu()),O(this)}),Object.defineProperty($.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty($.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty($.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(p){this._readableState&&(this._readableState.flowing=p)}}),$._fromList=_,Object.defineProperty($.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function _(d,p){if(p.length===0)return null;var I;return p.objectMode?I=p.buffer.shift():!d||d>=p.length?(p.decoder?I=p.buffer.join(""):p.buffer.length===1?I=p.buffer.first():I=p.buffer.concat(p.length),p.buffer.clear()):I=p.buffer.consume(d,p.decoder),I}function R(d){var p=d._readableState;l("endReadable",p.endEmitted),p.endEmitted||(p.ended=!0,process.nextTick(D,p,d))}function D(d,p){if(l("endReadableNT",d.endEmitted,d.length),!d.endEmitted&&d.length===0&&(d.endEmitted=!0,p.readable=!1,p.emit("end"),d.autoDestroy)){var I=p._writableState;(!I||I.autoDestroy&&I.finished)&&p.destroy()}}typeof Symbol=="function"&&($.from=function(d,p){return L===void 0&&(L=tu()),L($,d,p)});function j(d,p){for(var I=0,M=d.length;I<M;I++)if(d[I]===p)return I;return-1}return Wr}var gs=je,xr=lt.codes,ru=xr.ERR_METHOD_NOT_IMPLEMENTED,nu=xr.ERR_MULTIPLE_CALLBACK,iu=xr.ERR_TRANSFORM_ALREADY_TRANSFORMING,su=xr.ERR_TRANSFORM_WITH_LENGTH_0,vr=Bt();ge(je,vr);function ou(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new nu);r.writechunk=null,r.writecb=null,t!=null&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function je(e){if(!(this instanceof je))return new je(e);vr.call(this,e),this._transformState={afterTransform:ou.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",au)}function au(){var e=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(t,r){ri(e,t,r)}):ri(this,null,null)}je.prototype.push=function(e,t){return this._transformState.needTransform=!1,vr.prototype.push.call(this,e,t)};je.prototype._transform=function(e,t,r){r(new ru("_transform()"))};je.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};je.prototype._read=function(e){var t=this._transformState;t.writechunk!==null&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};je.prototype._destroy=function(e,t){vr.prototype._destroy.call(this,e,function(r){t(r)})};function ri(e,t,r){if(t)return e.emit("error",t);if(r!=null&&e.push(r),e._writableState.length)throw new su;if(e._transformState.transforming)throw new iu;return e.push(null)}var fu=Gt,ms=gs;ge(Gt,ms);function Gt(e){if(!(this instanceof Gt))return new Gt(e);ms.call(this,e)}Gt.prototype._transform=function(e,t,r){r(null,e)};var qr;function uu(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}var _s=lt.codes,cu=_s.ERR_MISSING_ARGS,lu=_s.ERR_STREAM_DESTROYED;function ni(e){if(e)throw e}function hu(e){return e.setHeader&&typeof e.abort=="function"}function du(e,t,r,n){n=uu(n);var i=!1;e.on("close",function(){i=!0}),qr===void 0&&(qr=An),qr(e,{readable:t,writable:r},function(f){if(f)return n(f);i=!0,n()});var a=!1;return function(f){if(!i&&!a){if(a=!0,hu(e))return e.abort();if(typeof e.destroy=="function")return e.destroy();n(f||new lu("pipe"))}}}function ii(e){e()}function pu(e,t){return e.pipe(t)}function bu(e){return!e.length||typeof e[e.length-1]!="function"?ni:e.pop()}function yu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=bu(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new cu("streams");var i,a=t.map(function(f,u){var l=u<t.length-1,b=u>0;return du(f,l,b,function(g){i||(i=g),g&&a.forEach(ii),!l&&(a.forEach(ii),n(i))})});return t.reduce(pu)}var gu=yu;(function(e,t){t=e.exports=ys(),t.Stream=t,t.Readable=t,t.Writable=ps(),t.Duplex=Bt(),t.Transform=gs,t.PassThrough=fu,t.finished=An,t.pipeline=gu})(rn,rn.exports);var mu=rn.exports,pr=Be.Buffer,ws=mu.Transform,_u=ge;function wu(e,t){if(!pr.isBuffer(e)&&typeof e!="string")throw new TypeError(t+" must be a string or a buffer")}function et(e){ws.call(this),this._block=pr.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}_u(et,ws);et.prototype._transform=function(e,t,r){var n=null;try{this.update(e,t)}catch(i){n=i}r(n)};et.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(r){t=r}e(t)};et.prototype.update=function(e,t){if(wu(e,"Data"),this._finalized)throw new Error("Digest already called");pr.isBuffer(e)||(e=pr.from(e,t));for(var r=this._block,n=0;this._blockOffset+e.length-n>=this._blockSize;){for(var i=this._blockOffset;i<this._blockSize;)r[i++]=e[n++];this._update(),this._blockOffset=0}for(;n<e.length;)r[this._blockOffset++]=e[n++];for(var a=0,f=e.length*8;f>0;++a)this._length[a]+=f,f=this._length[a]/4294967296|0,f>0&&(this._length[a]-=4294967296*f);return this};et.prototype._update=function(){throw new Error("_update is not implemented")};et.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();e!==void 0&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var r=0;r<4;++r)this._length[r]=0;return t};et.prototype._digest=function(){throw new Error("_digest is not implemented")};var xs=et,xu=ge,vs=xs,vu=Be.Buffer,Eu=new Array(16);function Er(){vs.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}xu(Er,vs);Er.prototype._update=function(){for(var e=Eu,t=0;t<16;++t)e[t]=this._block.readInt32LE(t*4);var r=this._a,n=this._b,i=this._c,a=this._d;r=de(r,n,i,a,e[0],3614090360,7),a=de(a,r,n,i,e[1],3905402710,12),i=de(i,a,r,n,e[2],606105819,17),n=de(n,i,a,r,e[3],3250441966,22),r=de(r,n,i,a,e[4],4118548399,7),a=de(a,r,n,i,e[5],1200080426,12),i=de(i,a,r,n,e[6],2821735955,17),n=de(n,i,a,r,e[7],4249261313,22),r=de(r,n,i,a,e[8],1770035416,7),a=de(a,r,n,i,e[9],2336552879,12),i=de(i,a,r,n,e[10],4294925233,17),n=de(n,i,a,r,e[11],2304563134,22),r=de(r,n,i,a,e[12],1804603682,7),a=de(a,r,n,i,e[13],4254626195,12),i=de(i,a,r,n,e[14],2792965006,17),n=de(n,i,a,r,e[15],1236535329,22),r=pe(r,n,i,a,e[1],4129170786,5),a=pe(a,r,n,i,e[6],3225465664,9),i=pe(i,a,r,n,e[11],643717713,14),n=pe(n,i,a,r,e[0],3921069994,20),r=pe(r,n,i,a,e[5],3593408605,5),a=pe(a,r,n,i,e[10],38016083,9),i=pe(i,a,r,n,e[15],3634488961,14),n=pe(n,i,a,r,e[4],3889429448,20),r=pe(r,n,i,a,e[9],568446438,5),a=pe(a,r,n,i,e[14],3275163606,9),i=pe(i,a,r,n,e[3],4107603335,14),n=pe(n,i,a,r,e[8],1163531501,20),r=pe(r,n,i,a,e[13],2850285829,5),a=pe(a,r,n,i,e[2],4243563512,9),i=pe(i,a,r,n,e[7],1735328473,14),n=pe(n,i,a,r,e[12],2368359562,20),r=be(r,n,i,a,e[5],4294588738,4),a=be(a,r,n,i,e[8],2272392833,11),i=be(i,a,r,n,e[11],1839030562,16),n=be(n,i,a,r,e[14],4259657740,23),r=be(r,n,i,a,e[1],2763975236,4),a=be(a,r,n,i,e[4],1272893353,11),i=be(i,a,r,n,e[7],4139469664,16),n=be(n,i,a,r,e[10],3200236656,23),r=be(r,n,i,a,e[13],681279174,4),a=be(a,r,n,i,e[0],3936430074,11),i=be(i,a,r,n,e[3],3572445317,16),n=be(n,i,a,r,e[6],76029189,23),r=be(r,n,i,a,e[9],3654602809,4),a=be(a,r,n,i,e[12],3873151461,11),i=be(i,a,r,n,e[15],530742520,16),n=be(n,i,a,r,e[2],3299628645,23),r=ye(r,n,i,a,e[0],4096336452,6),a=ye(a,r,n,i,e[7],1126891415,10),i=ye(i,a,r,n,e[14],2878612391,15),n=ye(n,i,a,r,e[5],4237533241,21),r=ye(r,n,i,a,e[12],1700485571,6),a=ye(a,r,n,i,e[3],2399980690,10),i=ye(i,a,r,n,e[10],4293915773,15),n=ye(n,i,a,r,e[1],2240044497,21),r=ye(r,n,i,a,e[8],1873313359,6),a=ye(a,r,n,i,e[15],4264355552,10),i=ye(i,a,r,n,e[6],2734768916,15),n=ye(n,i,a,r,e[13],1309151649,21),r=ye(r,n,i,a,e[4],4149444226,6),a=ye(a,r,n,i,e[11],3174756917,10),i=ye(i,a,r,n,e[2],718787259,15),n=ye(n,i,a,r,e[9],3951481745,21),this._a=this._a+r|0,this._b=this._b+n|0,this._c=this._c+i|0,this._d=this._d+a|0};Er.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=vu.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e};function Br(e,t){return e<<t|e>>>32-t}function de(e,t,r,n,i,a,f){return Br(e+(t&r|~t&n)+i+a|0,f)+t|0}function pe(e,t,r,n,i,a,f){return Br(e+(t&n|r&~n)+i+a|0,f)+t|0}function be(e,t,r,n,i,a,f){return Br(e+(t^r^n)+i+a|0,f)+t|0}function ye(e,t,r,n,i,a,f){return Br(e+(r^(t|~n))+i+a|0,f)+t|0}var Bu=Er,Vr=It.Buffer,Su=ge,Es=xs,Au=new Array(16),Ut=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],Mt=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],Nt=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],Dt=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],$t=[0,1518500249,1859775393,2400959708,2840853838],Ht=[1352829926,1548603684,1836072691,2053994217,0];function Sr(){Es.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}Su(Sr,Es);Sr.prototype._update=function(){for(var e=Au,t=0;t<16;++t)e[t]=this._block.readInt32LE(t*4);for(var r=this._a|0,n=this._b|0,i=this._c|0,a=this._d|0,f=this._e|0,u=this._a|0,l=this._b|0,b=this._c|0,g=this._d|0,m=this._e|0,v=0;v<80;v+=1){var A,B;v<16?(A=si(r,n,i,a,f,e[Ut[v]],$t[0],Nt[v]),B=ui(u,l,b,g,m,e[Mt[v]],Ht[0],Dt[v])):v<32?(A=oi(r,n,i,a,f,e[Ut[v]],$t[1],Nt[v]),B=fi(u,l,b,g,m,e[Mt[v]],Ht[1],Dt[v])):v<48?(A=ai(r,n,i,a,f,e[Ut[v]],$t[2],Nt[v]),B=ai(u,l,b,g,m,e[Mt[v]],Ht[2],Dt[v])):v<64?(A=fi(r,n,i,a,f,e[Ut[v]],$t[3],Nt[v]),B=oi(u,l,b,g,m,e[Mt[v]],Ht[3],Dt[v])):(A=ui(r,n,i,a,f,e[Ut[v]],$t[4],Nt[v]),B=si(u,l,b,g,m,e[Mt[v]],Ht[4],Dt[v])),r=f,f=a,a=ct(i,10),i=n,n=A,u=m,m=g,g=ct(b,10),b=l,l=B}var k=this._b+i+g|0;this._b=this._c+a+m|0,this._c=this._d+f+u|0,this._d=this._e+r+l|0,this._e=this._a+n+b|0,this._a=k};Sr.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=Vr.alloc?Vr.alloc(20):new Vr(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e};function ct(e,t){return e<<t|e>>>32-t}function si(e,t,r,n,i,a,f,u){return ct(e+(t^r^n)+a+f|0,u)+i|0}function oi(e,t,r,n,i,a,f,u){return ct(e+(t&r|~t&n)+a+f|0,u)+i|0}function ai(e,t,r,n,i,a,f,u){return ct(e+((t|~r)^n)+a+f|0,u)+i|0}function fi(e,t,r,n,i,a,f,u){return ct(e+(t&n|r&~n)+a+f|0,u)+i|0}function ui(e,t,r,n,i,a,f,u){return ct(e+(t^(r|~n))+a+f|0,u)+i|0}var Iu=Sr,Bs={exports:{}},Ss=Be.Buffer;function Ar(e,t){this._block=Ss.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}Ar.prototype.update=function(e,t){typeof e=="string"&&(t=t||"utf8",e=Ss.from(e,t));for(var r=this._block,n=this._blockSize,i=e.length,a=this._len,f=0;f<i;){for(var u=a%n,l=Math.min(i-f,n-u),b=0;b<l;b++)r[u+b]=e[f+b];a+=l,f+=l,a%n===0&&this._update(r)}return this._len+=i,this};Ar.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=this._len*8;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var n=(r&4294967295)>>>0,i=(r-n)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var a=this._hash();return e?a.toString(e):a};Ar.prototype._update=function(){throw new Error("_update must be implemented by subclass")};var Rt=Ar,Ru=ge,As=Rt,Tu=Be.Buffer,Pu=[1518500249,1859775393,-1894007588,-899497514],ku=new Array(80);function Xt(){this.init(),this._w=ku,As.call(this,64,56)}Ru(Xt,As);Xt.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function Cu(e){return e<<5|e>>>27}function Lu(e){return e<<30|e>>>2}function Ou(e,t,r,n){return e===0?t&r|~t&n:e===2?t&r|t&n|r&n:t^r^n}Xt.prototype._update=function(e){for(var t=this._w,r=this._a|0,n=this._b|0,i=this._c|0,a=this._d|0,f=this._e|0,u=0;u<16;++u)t[u]=e.readInt32BE(u*4);for(;u<80;++u)t[u]=t[u-3]^t[u-8]^t[u-14]^t[u-16];for(var l=0;l<80;++l){var b=~~(l/20),g=Cu(r)+Ou(b,n,i,a)+f+t[l]+Pu[b]|0;f=a,a=i,i=Lu(n),n=r,r=g}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=a+this._d|0,this._e=f+this._e|0};Xt.prototype._hash=function(){var e=Tu.allocUnsafe(20);return e.writeInt32BE(this._a|0,0),e.writeInt32BE(this._b|0,4),e.writeInt32BE(this._c|0,8),e.writeInt32BE(this._d|0,12),e.writeInt32BE(this._e|0,16),e};var Fu=Xt,Uu=ge,Is=Rt,Mu=Be.Buffer,Nu=[1518500249,1859775393,-1894007588,-899497514],Du=new Array(80);function Qt(){this.init(),this._w=Du,Is.call(this,64,56)}Uu(Qt,Is);Qt.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function $u(e){return e<<1|e>>>31}function Hu(e){return e<<5|e>>>27}function zu(e){return e<<30|e>>>2}function ju(e,t,r,n){return e===0?t&r|~t&n:e===2?t&r|t&n|r&n:t^r^n}Qt.prototype._update=function(e){for(var t=this._w,r=this._a|0,n=this._b|0,i=this._c|0,a=this._d|0,f=this._e|0,u=0;u<16;++u)t[u]=e.readInt32BE(u*4);for(;u<80;++u)t[u]=$u(t[u-3]^t[u-8]^t[u-14]^t[u-16]);for(var l=0;l<80;++l){var b=~~(l/20),g=Hu(r)+ju(b,n,i,a)+f+t[l]+Nu[b]|0;f=a,a=i,i=zu(n),n=r,r=g}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=a+this._d|0,this._e=f+this._e|0};Qt.prototype._hash=function(){var e=Mu.allocUnsafe(20);return e.writeInt32BE(this._a|0,0),e.writeInt32BE(this._b|0,4),e.writeInt32BE(this._c|0,8),e.writeInt32BE(this._d|0,12),e.writeInt32BE(this._e|0,16),e};var Gu=Qt,Wu=ge,Rs=Rt,qu=Be.Buffer,Vu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Ku=new Array(64);function Zt(){this.init(),this._w=Ku,Rs.call(this,64,56)}Wu(Zt,Rs);Zt.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function Yu(e,t,r){return r^e&(t^r)}function Ju(e,t,r){return e&t|r&(e|t)}function Xu(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function Qu(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function Zu(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function ec(e){return(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10}Zt.prototype._update=function(e){for(var t=this._w,r=this._a|0,n=this._b|0,i=this._c|0,a=this._d|0,f=this._e|0,u=this._f|0,l=this._g|0,b=this._h|0,g=0;g<16;++g)t[g]=e.readInt32BE(g*4);for(;g<64;++g)t[g]=ec(t[g-2])+t[g-7]+Zu(t[g-15])+t[g-16]|0;for(var m=0;m<64;++m){var v=b+Qu(f)+Yu(f,u,l)+Vu[m]+t[m]|0,A=Xu(r)+Ju(r,n,i)|0;b=l,l=u,u=f,f=a+v|0,a=i,i=n,n=r,r=v+A|0}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=a+this._d|0,this._e=f+this._e|0,this._f=u+this._f|0,this._g=l+this._g|0,this._h=b+this._h|0};Zt.prototype._hash=function(){var e=qu.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e};var Ts=Zt,tc=ge,rc=Ts,nc=Rt,ic=Be.Buffer,sc=new Array(64);function Ir(){this.init(),this._w=sc,nc.call(this,64,56)}tc(Ir,rc);Ir.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this};Ir.prototype._hash=function(){var e=ic.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e};var oc=Ir,ac=ge,Ps=Rt,fc=Be.Buffer,ci=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],uc=new Array(160);function er(){this.init(),this._w=uc,Ps.call(this,128,112)}ac(er,Ps);er.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function li(e,t,r){return r^e&(t^r)}function hi(e,t,r){return e&t|r&(e|t)}function di(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function pi(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function cc(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function lc(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function hc(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function dc(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function le(e,t){return e>>>0<t>>>0?1:0}er.prototype._update=function(e){for(var t=this._w,r=this._ah|0,n=this._bh|0,i=this._ch|0,a=this._dh|0,f=this._eh|0,u=this._fh|0,l=this._gh|0,b=this._hh|0,g=this._al|0,m=this._bl|0,v=this._cl|0,A=this._dl|0,B=this._el|0,k=this._fl|0,T=this._gl|0,C=this._hl|0,F=0;F<32;F+=2)t[F]=e.readInt32BE(F*4),t[F+1]=e.readInt32BE(F*4+4);for(;F<160;F+=2){var O=t[F-30],L=t[F-15*2+1],U=cc(O,L),S=lc(L,O);O=t[F-2*2],L=t[F-2*2+1];var z=hc(O,L),N=dc(L,O),$=t[F-7*2],oe=t[F-7*2+1],Pe=t[F-16*2],Ge=t[F-16*2+1],fe=S+oe|0,ve=U+$+le(fe,S)|0;fe=fe+N|0,ve=ve+z+le(fe,N)|0,fe=fe+Ge|0,ve=ve+Pe+le(fe,Ge)|0,t[F]=ve,t[F+1]=fe}for(var Ee=0;Ee<160;Ee+=2){ve=t[Ee],fe=t[Ee+1];var tt=hi(r,n,i),ke=hi(g,m,v),We=di(r,g),Ce=di(g,r),qe=pi(f,B),Z=pi(B,f),ae=ci[Ee],Se=ci[Ee+1],Ve=li(f,u,l),Me=li(B,k,T),w=C+Z|0,_=b+qe+le(w,C)|0;w=w+Me|0,_=_+Ve+le(w,Me)|0,w=w+Se|0,_=_+ae+le(w,Se)|0,w=w+fe|0,_=_+ve+le(w,fe)|0;var R=Ce+ke|0,D=We+tt+le(R,Ce)|0;b=l,C=T,l=u,T=k,u=f,k=B,B=A+w|0,f=a+_+le(B,A)|0,a=i,A=v,i=n,v=m,n=r,m=g,g=w+R|0,r=_+D+le(g,w)|0}this._al=this._al+g|0,this._bl=this._bl+m|0,this._cl=this._cl+v|0,this._dl=this._dl+A|0,this._el=this._el+B|0,this._fl=this._fl+k|0,this._gl=this._gl+T|0,this._hl=this._hl+C|0,this._ah=this._ah+r+le(this._al,g)|0,this._bh=this._bh+n+le(this._bl,m)|0,this._ch=this._ch+i+le(this._cl,v)|0,this._dh=this._dh+a+le(this._dl,A)|0,this._eh=this._eh+f+le(this._el,B)|0,this._fh=this._fh+u+le(this._fl,k)|0,this._gh=this._gh+l+le(this._gl,T)|0,this._hh=this._hh+b+le(this._hl,C)|0};er.prototype._hash=function(){var e=fc.allocUnsafe(64);function t(r,n,i){e.writeInt32BE(r,i),e.writeInt32BE(n,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e};var ks=er,pc=ge,bc=ks,yc=Rt,gc=Be.Buffer,mc=new Array(160);function Rr(){this.init(),this._w=mc,yc.call(this,128,112)}pc(Rr,bc);Rr.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this};Rr.prototype._hash=function(){var e=gc.allocUnsafe(48);function t(r,n,i){e.writeInt32BE(r,i),e.writeInt32BE(n,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e};var _c=Rr,ht=Bs.exports=function(t){t=t.toLowerCase();var r=ht[t];if(!r)throw new Error(t+" is not supported (we accept pull requests)");return new r};ht.sha=Fu;ht.sha1=Gu;ht.sha224=oc;ht.sha256=Ts;ht.sha384=_c;ht.sha512=ks;var wc=Bs.exports,Cs=Be.Buffer,Ls=Bn.Transform,xc=dr.StringDecoder,vc=ge;function Le(e){Ls.call(this),this.hashMode=typeof e=="string",this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}vc(Le,Ls);Le.prototype.update=function(e,t,r){typeof e=="string"&&(e=Cs.from(e,t));var n=this._update(e);return this.hashMode?this:(r&&(n=this._toString(n,r)),n)};Le.prototype.setAutoPadding=function(){};Le.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")};Le.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")};Le.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")};Le.prototype._transform=function(e,t,r){var n;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(i){n=i}finally{r(n)}};Le.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(r){t=r}e(t)};Le.prototype._finalOrDigest=function(e){var t=this.__final()||Cs.alloc(0);return e&&(t=this._toString(t,e,!0)),t};Le.prototype._toString=function(e,t,r){if(this._decoder||(this._decoder=new xc(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var n=this._decoder.write(e);return r&&(n+=this._decoder.end()),n};var Ec=Le,Bc=ge,Sc=Bu,Ac=Iu,Ic=wc,Os=Ec;function Tr(e){Os.call(this,"digest"),this._hash=e}Bc(Tr,Os);Tr.prototype._update=function(e){this._hash.update(e)};Tr.prototype._final=function(){return this._hash.digest()};var Rc=function(t){return t=t.toLowerCase(),t==="md5"?new Sc:t==="rmd160"||t==="ripemd160"?new Ac:new Tr(Ic(t))},nr=Be.Buffer;function Tc(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),a=i.charCodeAt(0);if(t[a]!==255)throw new TypeError(i+" is ambiguous");t[a]=n}var f=e.length,u=e.charAt(0),l=Math.log(f)/Math.log(256),b=Math.log(256)/Math.log(f);function g(A){if((Array.isArray(A)||A instanceof Uint8Array)&&(A=nr.from(A)),!nr.isBuffer(A))throw new TypeError("Expected Buffer");if(A.length===0)return"";for(var B=0,k=0,T=0,C=A.length;T!==C&&A[T]===0;)T++,B++;for(var F=(C-T)*b+1>>>0,O=new Uint8Array(F);T!==C;){for(var L=A[T],U=0,S=F-1;(L!==0||U<k)&&S!==-1;S--,U++)L+=256*O[S]>>>0,O[S]=L%f>>>0,L=L/f>>>0;if(L!==0)throw new Error("Non-zero carry");k=U,T++}for(var z=F-k;z!==F&&O[z]===0;)z++;for(var N=u.repeat(B);z<F;++z)N+=e.charAt(O[z]);return N}function m(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return nr.alloc(0);for(var B=0,k=0,T=0;A[B]===u;)k++,B++;for(var C=(A.length-B)*l+1>>>0,F=new Uint8Array(C);B<A.length;){var O=t[A.charCodeAt(B)];if(O===255)return;for(var L=0,U=C-1;(O!==0||L<T)&&U!==-1;U--,L++)O+=f*F[U]>>>0,F[U]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");T=L,B++}for(var S=C-T;S!==C&&F[S]===0;)S++;var z=nr.allocUnsafe(k+(C-S));z.fill(0,0,k);for(var N=k;S!==C;)z[N++]=F[S++];return z}function v(A){var B=m(A);if(B)return B;throw new Error("Non-base"+f+" character")}return{encode:g,decodeUnsafe:m,decode:v}}var Pc=Tc,kc=Pc,Cc="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",Lc=kc(Cc),Kr=Lc,Oc=Be.Buffer,Fc=function(e){function t(a){var f=e(a);return Kr.encode(Oc.concat([a,f],a.length+4))}function r(a){var f=a.slice(0,-4),u=a.slice(-4),l=e(f);if(!(u[0]^l[0]|u[1]^l[1]|u[2]^l[2]|u[3]^l[3]))return f}function n(a){var f=Kr.decodeUnsafe(a);if(f)return r(f)}function i(a){var f=Kr.decode(a),u=r(f);if(!u)throw new Error("Invalid checksum");return u}return{encode:t,decode:i,decodeUnsafe:n}},bi=Rc,Uc=Fc;function Mc(e){var t=bi("sha256").update(e).digest();return bi("sha256").update(t).digest()}var Nc=Uc(Mc),sn=Nc;function Fs(e,t){if(t!==void 0&&e[0]!==t)throw new Error("Invalid network version");if(e.length===33)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(e.length!==34)throw new Error("Invalid WIF length");if(e[33]!==1)throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}function on(e,t,r){var n=new Buffer(r?34:33);return n.writeUInt8(e,0),t.copy(n,1),r&&(n[33]=1),n}function Dc(e,t){return Fs(sn.decode(e),t)}function $c(e,t,r){return typeof e=="number"?sn.encode(on(e,t,r)):sn.encode(on(e.version,e.privateKey,e.compressed))}var Hc={decode:Dc,decodeRaw:Fs,encode:$c,encodeRaw:on},Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});Pr.testEcc=void 0;const H=e=>Buffer.from(e,"hex");function zc(e){X(e.isPoint(H("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),X(!e.isPoint(H("030000000000000000000000000000000000000000000000000000000000000005"))),X(e.isPrivate(H("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),X(e.isPrivate(H("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),X(!e.isPrivate(H("0000000000000000000000000000000000000000000000000000000000000000"))),X(!e.isPrivate(H("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),X(!e.isPrivate(H("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),X(Buffer.from(e.privateAdd(H("0000000000000000000000000000000000000000000000000000000000000001"),H("0000000000000000000000000000000000000000000000000000000000000000"))).equals(H("0000000000000000000000000000000000000000000000000000000000000001"))),X(e.privateAdd(H("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),H("0000000000000000000000000000000000000000000000000000000000000003"))===null),X(Buffer.from(e.privateAdd(H("e211078564db65c3ce7704f08262b1f38f1ef412ad15b5ac2d76657a63b2c500"),H("b51fbb69051255d1becbd683de5848242a89c229348dd72896a87ada94ae8665"))).equals(H("9730c2ee69edbb958d42db7460bafa18fef9d955325aec99044c81c8282b0a24"))),X(Buffer.from(e.privateNegate(H("0000000000000000000000000000000000000000000000000000000000000001"))).equals(H("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),X(Buffer.from(e.privateNegate(H("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"))).equals(H("0000000000000000000000000000000000000000000000000000000000000003"))),X(Buffer.from(e.privateNegate(H("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(H("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792"))),X(Buffer.from(e.pointCompress(H("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0)).equals(H("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),X(Buffer.from(e.pointCompress(H("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1)).equals(H("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),X(Buffer.from(e.pointCompress(H("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0)).equals(H("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),X(Buffer.from(e.pointCompress(H("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1)).equals(H("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),X(Buffer.from(e.pointFromScalar(H("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(H("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),X(e.xOnlyPointAddTweak(H("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),H("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))===null);let t=e.xOnlyPointAddTweak(H("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),H("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));X(Buffer.from(t.xOnlyPubkey).equals(H("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&t.parity===1),t=e.xOnlyPointAddTweak(H("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),H("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47")),X(Buffer.from(t.xOnlyPubkey).equals(H("9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"))&&t.parity===0),X(Buffer.from(e.sign(H("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),H("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(H("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),X(e.verify(H("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),H("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),H("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),e.signSchnorr&&X(Buffer.from(e.signSchnorr(H("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),H("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),H("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(H("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),e.verifySchnorr&&X(e.verifySchnorr(H("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),H("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),H("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}Pr.testEcc=zc;function X(e){if(!e)throw new Error("ecc library invalid")}Object.defineProperty(vt,"__esModule",{value:!0});vt.ECPairFactory=vt.networks=void 0;const an=Et;vt.networks=an;const _e=Ki,jc=yf,yi=Hc,Gc=Pr,Yr=_e.typeforce.maybe(_e.typeforce.compile({compressed:_e.maybe(_e.Boolean),network:_e.maybe(_e.Network)})),Wc=e=>e.length===32?e:e.slice(1,33);function qc(e){(0,Gc.testEcc)(e);function t(u){return e.isPoint(u)}function r(u,l){if(_e.typeforce(_e.Buffer256bit,u),!e.isPrivate(u))throw new TypeError("Private key not in range [1, n)");return _e.typeforce(Yr,l),new f(u,void 0,l)}function n(u,l){return _e.typeforce(e.isPoint,u),_e.typeforce(Yr,l),new f(void 0,u,l)}function i(u,l){const b=yi.decode(u),g=b.version;if(_e.Array(l)){if(l=l.filter(m=>g===m.wif).pop(),!l)throw new Error("Unknown network version")}else if(l=l||an.bitcoin,g!==l.wif)throw new Error("Invalid network version");return r(b.privateKey,{compressed:b.compressed,network:l})}function a(u){_e.typeforce(Yr,u),u===void 0&&(u={});const l=u.rng||jc;let b;do b=l(32),_e.typeforce(_e.Buffer256bit,b);while(!e.isPrivate(b));return r(b,u)}class f{constructor(l,b,g){bt(this,"__D");bt(this,"__Q");bt(this,"compressed");bt(this,"network");bt(this,"lowR");this.__D=l,this.__Q=b,this.lowR=!1,g===void 0&&(g={}),this.compressed=g.compressed===void 0?!0:g.compressed,this.network=g.network||an.bitcoin,b!==void 0&&(this.__Q=Buffer.from(e.pointCompress(b,this.compressed)))}get privateKey(){return this.__D}get publicKey(){if(!this.__Q){const l=e.pointFromScalar(this.__D,this.compressed);this.__Q=Buffer.from(l)}return this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return yi.encode(this.network.wif,this.__D,this.compressed)}tweak(l){return this.privateKey?this.tweakFromPrivateKey(l):this.tweakFromPublicKey(l)}sign(l,b){if(!this.__D)throw new Error("Missing private key");if(b===void 0&&(b=this.lowR),b===!1)return Buffer.from(e.sign(l,this.__D));{let g=e.sign(l,this.__D);const m=Buffer.alloc(32,0);let v=0;for(;g[0]>127;)v++,m.writeUIntLE(v,0,6),g=e.sign(l,this.__D,m);return Buffer.from(g)}}signSchnorr(l){if(!this.privateKey)throw new Error("Missing private key");if(!e.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return Buffer.from(e.signSchnorr(l,this.privateKey))}verify(l,b){return e.verify(l,this.publicKey,b)}verifySchnorr(l,b){if(!e.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return e.verifySchnorr(l,this.publicKey.subarray(1,33),b)}tweakFromPublicKey(l){const b=Wc(this.publicKey),g=e.xOnlyPointAddTweak(b,l);if(!g||g.xOnlyPubkey===null)throw new Error("Cannot tweak public key!");const m=Buffer.from([g.parity===0?2:3]);return n(Buffer.concat([m,g.xOnlyPubkey]),{network:this.network,compressed:this.compressed})}tweakFromPrivateKey(l){const g=this.publicKey[0]===3||this.publicKey[0]===4&&(this.publicKey[64]&1)===1?e.privateNegate(this.privateKey):this.privateKey,m=e.privateAdd(g,l);if(!m)throw new Error("Invalid tweaked private key!");return r(Buffer.from(m),{network:this.network,compressed:this.compressed})}}return{isPoint:t,fromPrivateKey:r,fromPublicKey:n,fromWIF:i,makeRandom:a}}vt.ECPairFactory=qc;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.networks=e.ECPairFactory=e.default=void 0;var t=vt;Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.ECPairFactory}}),Object.defineProperty(e,"ECPairFactory",{enumerable:!0,get:function(){return t.ECPairFactory}}),Object.defineProperty(e,"networks",{enumerable:!0,get:function(){return t.networks}})})(Vi);const Vc=Ka(Vi);class br{constructor(t){this.privKey=t}static fromPrivKey(t){return new br(P.trim0x(t))}static async fromWalletClient(t){if(!t.account)return P.Err("No account found");try{const r=await t.signTypedData({account:t.account,types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"}],Data:[{name:"Message",type:"string"},{name:"Version",type:"string"},{name:"Nonce",type:"uint256"}]},domain:{name:"WBTC GARDEN",version:"1"},primaryType:"Data",message:{Message:"Initialize your account",Version:"1.0.2",Nonce:1n}});return P.Ok(new br(P.trim0x(He.sha256(r))))}catch(r){return P.Err("Failed to initialize: "+r)}}getMasterPrivKey(){return this.privKey}generateSecret(t){const r=this.signMessage(t),n=He.sha256(we.with0x(r)),i=He.sha256(n);return P.Ok({secret:n,secretHash:i})}signMessage(t){const r=Vc(st),n="Garden.fi"+t.toString(),i=Buffer.from(n,"utf8"),a=He.sha256(i),f=Buffer.from(P.trim0x(this.privKey),"hex");if(f.length!==32)throw new Error("Invalid private key length. Expected 32 bytes.");return r.fromPrivateKey(f).sign(Buffer.from(P.trim0x(a),"hex")).toString("hex")}}class Kc{constructor(t){this.quoteUrl=new we.Url("/quote",t)}async getQuote(t,r,n=!1){try{const i=this.quoteUrl.addSearchParams({order_pair:t,amount:r.toString(),exact_out:n.toString()}),a=await P.Fetcher.get(i);return a.error?P.Err(a.error):a.result?P.Ok(a.result):P.Err("GetQuote: Unexpected error, result is undefined")}catch(i){return P.Err("GetQuote:",String(i))}}async getAttestedQuote(t){try{const r=await P.Fetcher.post(this.quoteUrl.endpoint("/attested").toString(),{body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});return r.error?P.Err(r.error):r.result?P.Ok(r.result):P.Err("GetAttestedQuote: Unexpected error, result is undefined")}catch(r){return console.log("error :",r),P.Err("GetAttestedQuote:",String(r))}}async getStrategies(){try{const t=await P.Fetcher.get(this.quoteUrl.endpoint("/strategies"));if(t.error)return P.Err(t.error);if(!t.result)return P.Err("GetStrategies: Unexpected error, result is undefined");const r={};for(const n of Object.values(t.result)){const i=Gi(n.source_chain,n.source_asset.asset,n.dest_chain,n.dest_asset.asset);r[i]={id:n.id,minAmount:n.min_amount,maxAmount:n.max_amount}}return P.Ok(r)}catch(t){return P.Err("GetStrategies:",String(t))}}}exports.BlockNumberFetcher=Va;exports.EvmRelay=qi;exports.Garden=qa;exports.OrderActions=ce;exports.OrderStatus=re;exports.ParseOrderStatus=gn;exports.ParseSwapStatus=Qr;exports.Quote=Kc;exports.SecretManager=br;exports.SwapStatus=ne;exports.TimeLocks=or;exports.constructOrderPair=Gi;exports.evmToViemChainMap=ji;exports.filterDeadlineExpiredOrders=Wi;exports.isExpired=zt;exports.parseAction=Na;exports.parseActionFromStatus=mn;exports.switchOrAddNetwork=Fa;exports.validateBTCAddress=Ma;
